/*!
 * JavaScript for PHPMaker v2021.0.5
 * Copyright (c) e.World Technology Limited. All rights reserved.
 */
!function(e){"use strict";e=e&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e;var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:{};var a=function(e,t,a){return e(a={path:t,exports:{},require:function(e,t){return function(){throw new Error("Dynamic requires are not currently supported by @rollup/plugin-commonjs")}(null==t&&a.path)}},a.exports),a.exports}((function(e){var t=function(e){var t=Object.prototype,a=t.hasOwnProperty,n="function"==typeof Symbol?Symbol:{},r=n.iterator||"@@iterator",i=n.asyncIterator||"@@asyncIterator",o=n.toStringTag||"@@toStringTag";function s(e,t,a,n){var r=t&&t.prototype instanceof c?t:c,i=Object.create(r.prototype),o=new _(n||[]);return i._invoke=function(e,t,a){var n="suspendedStart";return function(r,i){if("executing"===n)throw new Error("Generator is already running");if("completed"===n){if("throw"===r)throw i;return x()}for(a.method=r,a.arg=i;;){var o=a.delegate;if(o){var s=b(o,a);if(s){if(s===d)continue;return s}}if("next"===a.method)a.sent=a._sent=a.arg;else if("throw"===a.method){if("suspendedStart"===n)throw n="completed",a.arg;a.dispatchException(a.arg)}else"return"===a.method&&a.abrupt("return",a.arg);n="executing";var c=l(e,t,a);if("normal"===c.type){if(n=a.done?"completed":"suspendedYield",c.arg===d)continue;return{value:c.arg,done:a.done}}"throw"===c.type&&(n="completed",a.method="throw",a.arg=c.arg)}}}(e,a,o),i}function l(e,t,a){try{return{type:"normal",arg:e.call(t,a)}}catch(e){return{type:"throw",arg:e}}}e.wrap=s;var d={};function c(){}function u(){}function p(){}var f={};f[r]=function(){return this};var h=Object.getPrototypeOf,g=h&&h(h(S([])));g&&g!==t&&a.call(g,r)&&(f=g);var m=p.prototype=c.prototype=Object.create(f);function w(e){["next","throw","return"].forEach((function(t){e[t]=function(e){return this._invoke(t,e)}}))}function v(e,t){var n;this._invoke=function(r,i){function o(){return new t((function(n,o){!function n(r,i,o,s){var d=l(e[r],e,i);if("throw"!==d.type){var c=d.arg,u=c.value;return u&&"object"==typeof u&&a.call(u,"__await")?t.resolve(u.__await).then((function(e){n("next",e,o,s)}),(function(e){n("throw",e,o,s)})):t.resolve(u).then((function(e){c.value=e,o(c)}),(function(e){return n("throw",e,o,s)}))}s(d.arg)}(r,i,n,o)}))}return n=n?n.then(o,o):o()}}function b(e,t){var a=e.iterator[t.method];if(void 0===a){if(t.delegate=null,"throw"===t.method){if(e.iterator.return&&(t.method="return",t.arg=void 0,b(e,t),"throw"===t.method))return d;t.method="throw",t.arg=new TypeError("The iterator does not provide a 'throw' method")}return d}var n=l(a,e.iterator,t.arg);if("throw"===n.type)return t.method="throw",t.arg=n.arg,t.delegate=null,d;var r=n.arg;return r?r.done?(t[e.resultName]=r.value,t.next=e.nextLoc,"return"!==t.method&&(t.method="next",t.arg=void 0),t.delegate=null,d):r:(t.method="throw",t.arg=new TypeError("iterator result is not an object"),t.delegate=null,d)}function y(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function E(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function _(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(y,this),this.reset(!0)}function S(e){if(e){var t=e[r];if(t)return t.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var n=-1,i=function t(){for(;++n<e.length;)if(a.call(e,n))return t.value=e[n],t.done=!1,t;return t.value=void 0,t.done=!0,t};return i.next=i}}return{next:x}}function x(){return{value:void 0,done:!0}}return u.prototype=m.constructor=p,p.constructor=u,p[o]=u.displayName="GeneratorFunction",e.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===u||"GeneratorFunction"===(t.displayName||t.name))},e.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,p):(e.__proto__=p,o in e||(e[o]="GeneratorFunction")),e.prototype=Object.create(m),e},e.awrap=function(e){return{__await:e}},w(v.prototype),v.prototype[i]=function(){return this},e.AsyncIterator=v,e.async=function(t,a,n,r,i){void 0===i&&(i=Promise);var o=new v(s(t,a,n,r),i);return e.isGeneratorFunction(a)?o:o.next().then((function(e){return e.done?e.value:o.next()}))},w(m),m[o]="Generator",m[r]=function(){return this},m.toString=function(){return"[object Generator]"},e.keys=function(e){var t=[];for(var a in e)t.push(a);return t.reverse(),function a(){for(;t.length;){var n=t.pop();if(n in e)return a.value=n,a.done=!1,a}return a.done=!0,a}},e.values=S,_.prototype={constructor:_,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=void 0,this.done=!1,this.delegate=null,this.method="next",this.arg=void 0,this.tryEntries.forEach(E),!e)for(var t in this)"t"===t.charAt(0)&&a.call(this,t)&&!isNaN(+t.slice(1))&&(this[t]=void 0)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var t=this;function n(a,n){return o.type="throw",o.arg=e,t.next=a,n&&(t.method="next",t.arg=void 0),!!n}for(var r=this.tryEntries.length-1;r>=0;--r){var i=this.tryEntries[r],o=i.completion;if("root"===i.tryLoc)return n("end");if(i.tryLoc<=this.prev){var s=a.call(i,"catchLoc"),l=a.call(i,"finallyLoc");if(s&&l){if(this.prev<i.catchLoc)return n(i.catchLoc,!0);if(this.prev<i.finallyLoc)return n(i.finallyLoc)}else if(s){if(this.prev<i.catchLoc)return n(i.catchLoc,!0)}else{if(!l)throw new Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return n(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var r=this.tryEntries[n];if(r.tryLoc<=this.prev&&a.call(r,"finallyLoc")&&this.prev<r.finallyLoc){var i=r;break}}i&&("break"===e||"continue"===e)&&i.tryLoc<=t&&t<=i.finallyLoc&&(i=null);var o=i?i.completion:{};return o.type=e,o.arg=t,i?(this.method="next",this.next=i.finallyLoc,d):this.complete(o)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),d},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.finallyLoc===e)return this.complete(a.completion,a.afterLoc),E(a),d}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var a=this.tryEntries[t];if(a.tryLoc===e){var n=a.completion;if("throw"===n.type){var r=n.arg;E(a)}return r}}throw new Error("illegal catch attempt")},delegateYield:function(e,t,a){return this.delegate={iterator:S(e),resultName:t,nextLoc:a},"next"===this.method&&(this.arg=void 0),d}},e}(e.exports);try{regeneratorRuntime=t}catch(e){Function("r","regeneratorRuntime = r")(t)}}));function n(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"==typeof e)return r(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return r(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(a=e[Symbol.iterator]()).next.bind(a)}function r(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}if("undefined"!=typeof Blob&&("undefined"==typeof FormData||!FormData.prototype.keys)){var i=function(e){var t=e[0],a=e[1];return t instanceof Blob&&(t=new File([t],a,{type:t.type,lastModified:t.lastModified})),t},o=function(e,t){if(e.length<t)throw new TypeError(t+" argument required, but only "+e.length+" present.")},s=function(e,t,a){return t instanceof Blob?[String(e),t,void 0!==a?a+"":"string"==typeof t.name?t.name:"blob"]:[String(e),String(t)]},l=function(e,t){for(var a=0;a<e.length;a++)t(e[a])},d="object"==typeof window?window:"object"==typeof self?self:t,c=d.FormData,u=d.XMLHttpRequest&&d.XMLHttpRequest.prototype.send,p=d.Request&&d.fetch,f=d.navigator&&d.navigator.sendBeacon,h=d.Symbol&&Symbol.toStringTag;h&&(Blob.prototype[h]||(Blob.prototype[h]="Blob"),"File"in d&&!File.prototype[h]&&(File.prototype[h]="File"));try{new File([],"")}catch(e){d.File=function(e,t,a){var n=new Blob(e,a),r=a&&void 0!==a.lastModified?new Date(a.lastModified):new Date;return Object.defineProperties(n,{name:{value:t},lastModifiedDate:{value:r},lastModified:{value:+r},toString:{value:function(){return"[object File]"}}}),h&&Object.defineProperty(n,h,{value:"File"}),n}}var g=function(){function e(e){if(this._data=Object.create(null),!e)return this;var t=this;l(e.elements,(function(e){if(e.name&&!e.disabled&&"submit"!==e.type&&"button"!==e.type)if("file"===e.type){var a=e.files&&e.files.length?e.files:[new File([],"",{type:"application/octet-stream"})];l(a,(function(a){t.append(e.name,a)}))}else if("select-multiple"===e.type||"select-one"===e.type)l(e.options,(function(a){!a.disabled&&a.selected&&t.append(e.name,a.value)}));else if("checkbox"===e.type||"radio"===e.type)e.checked&&t.append(e.name,e.value);else{var n="textarea"===e.type?function(e){return e.replace(/\r\n/g,"\n").replace(/\n/g,"\r\n")}(e.value):e.value;t.append(e.name,n)}}))}var t=e.prototype;return t.append=function(e,t,a){o(arguments,2);var n=s.apply(null,arguments);e=n[0],t=n[1],a=n[2];var r=this._data;r[e]||(r[e]=[]),r[e].push([t,a])},t.delete=function(e){o(arguments,1),delete this._data[String(e)]},t.entries=a.mark((function e(){var t,r,o,s,l;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=this._data,e.t0=a.keys(t);case 2:if((e.t1=e.t0()).done){e.next=13;break}r=e.t1.value,o=n(t[r]);case 5:if((s=o()).done){e.next=11;break}return l=s.value,e.next=9,[r,i(l)];case 9:e.next=5;break;case 11:e.next=2;break;case 13:case"end":return e.stop()}}),e,this)})),t.forEach=function(e,t){o(arguments,1);for(var a,r=n(this);!(a=r()).done;){var i=a.value,s=i[0],l=i[1];e.call(t,l,s,this)}},t.get=function(e){o(arguments,1);var t=this._data;return t[e=String(e)]?i(t[e][0]):null},t.getAll=function(e){return o(arguments,1),(this._data[String(e)]||[]).map(i)},t.has=function(e){return o(arguments,1),String(e)in this._data},t.keys=a.mark((function e(){var t,r,i,o;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n(this);case 1:if((r=t()).done){e.next=7;break}return i=r.value,o=i[0],e.next=5,o;case 5:e.next=1;break;case 7:case"end":return e.stop()}}),e,this)})),t.set=function(e,t,a){o(arguments,2);var n=s.apply(null,arguments);this._data[n[0]]=[[n[1],n[2]]]},t.values=a.mark((function e(){var t,r,i,o;return a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t=n(this);case 1:if((r=t()).done){e.next=7;break}return i=r.value,o=i[1],e.next=5,o;case 5:e.next=1;break;case 7:case"end":return e.stop()}}),e,this)})),t._asNative=function(){for(var e,t=new c,a=n(this);!(e=a()).done;){var r=e.value,i=r[0],o=r[1];t.append(i,o)}return t},t._blob=function(){for(var e,t="----formdata-polyfill-"+Math.random(),a=[],r=n(this);!(e=r()).done;){var i=e.value,o=i[0],s=i[1];a.push("--"+t+"\r\n"),s instanceof Blob?a.push('Content-Disposition: form-data; name="'+o+'"; filename="'+s.name+'"\r\n',"Content-Type: "+(s.type||"application/octet-stream")+"\r\n\r\n",s,"\r\n"):a.push('Content-Disposition: form-data; name="'+o+'"\r\n\r\n'+s+"\r\n")}return a.push("--"+t+"--"),new Blob(a,{type:"multipart/form-data; boundary="+t})},t[Symbol.iterator]=function(){return this.entries()},t.toString=function(){return"[object FormData]"},e}();if(h&&(g.prototype[h]="FormData"),u){var m=d.XMLHttpRequest.prototype.setRequestHeader;d.XMLHttpRequest.prototype.setRequestHeader=function(e,t){m.call(this,e,t),"content-type"===e.toLowerCase()&&(this._hasContentType=!0)},d.XMLHttpRequest.prototype.send=function(e){if(e instanceof g){var t=e._blob();this._hasContentType||this.setRequestHeader("Content-Type",t.type),u.call(this,t)}else u.call(this,e)}}if(p){var w=d.fetch;d.fetch=function(e,t){return t&&t.body&&t.body instanceof g&&(t.body=t.body._blob()),w.call(this,e,t)}}f&&(d.navigator.sendBeacon=function(e,t){return t instanceof g&&(t=t._asNative()),f.call(this,e,t)}),d.FormData=g}var v=Object.freeze({__proto__:null,userLevelId:function(e){return e&&!ew.checkInteger(e.value)?{userLevelId:ew.language.phrase("UserLevelIDInteger")}:parseInt(e.value,10)<1&&{userLevelId:ew.language.phrase("UserLevelIDIncorrect")}},userLevelName:function(e){return function(t){var a=document.getElementById("x_"+e);if(a&&t){var n=t.value.trim(),r=parseInt(a.value.trim(),10);if(0===r&&!ew.sameText(n,"Default"))return{userLevelName:ew.language.phrase("UserLevelDefaultName")};if(-1===r&&!ew.sameText(n,"Administrator"))return{userLevelName:ew.language.phrase("UserLevelAdministratorName")};if(-2===r&&!ew.sameText(n,"Anonymous"))return{userLevelName:ew.language.phrase("UserLevelAnonymousName")};if(r>0&&["anonymous","administrator","default"].includes(n.toLowerCase()))return{userLevelName:ew.language.phrase("UserLevelNameIncorrect")}}return!1}},required:function(t){return function(a){var n,r=e(a),i=r.closest("#r_"+(null===(n=r.data("field"))||void 0===n?void 0:n.substr(2)));return i[0]||(i=r.closest("[id^=el]")),"none"!=i.css("display")&&(!(!a||ew.hasValue(a))&&{required:ew.language.phrase("EnterRequiredField").replace("%s",t)})}},fileRequired:function(e){return function(t){var a=document.getElementById("fn_"+t.id);return!(!a||ew.hasValue(a))&&{fileRequired:ew.language.phrase("EnterRequiredField").replace("%s",e)}}},mismatchPassword:function(e){var t;e.id.startsWith("c_")?t=e.id.replace(/^c_/,"x_"):"cpwd"==e.id&&(t="npwd");var a=document.getElementById(t);return e.value!==a.value&&{mismatchPassword:ew.language.phrase("MismatchPassword")}},between:function(t){var a,n;return t.id.startsWith("y_")&&(a=document.getElementById(t.id.replace(/^y_/,"x_")),n=document.getElementById(t.id.replace(/^y_/,"z_"))),!(!ew.hasValue(a)||"BETWEEN"!=e(n).val()||ew.hasValue(t))&&{between:ew.language.phrase("EnterValue2")}},passwordStrength:function(t){var a=e(t);return!(ew.isMaskedPassword(t)||!a.hasClass("ew-password-strength")||a.data("validated"))&&{passwordStrength:ew.language.phrase("PasswordTooSimple")}},username:function(e){return function(t){return!(e||!t.value.match(new RegExp("["+ew.escapeRegExChars(ew.INVALID_USERNAME_CHARACTERS)+"]")))&&{username:ew.language.phrase("InvalidUsernameChars")}}},password:function(e){return function(t){return!(e||ew.ENCRYPTED_PASSWORD||!t.value.match(new RegExp("["+ew.escapeRegExChars(ew.INVALID_PASSWORD_CHARACTERS)+"]")))&&{password:ew.language.phrase("InvalidPasswordChars")}}},email:function(e){var t=ew.getValue(e);return!ew.checkEmail(t)&&{email:ew.language.phrase("IncorrectEmail")}},emails:function(e,t){return function(a){var n=ew.getValue(a);return!ew.checkEmails(n,e)&&{email:t}}},datetime:function(e){return function(t){var a,n,r=ew.getValue(t),i=ew.DATE_SEPARATOR;return[12,15,115].includes(e)?(a=ew.checkShortDate,n="IncorrectShortDateYMD"):[5,9,109].includes(e)?(a=ew.checkDate,n="IncorrectDateYMD"):[14,17,117].includes(e)?(a=ew.checkShortEuroDate,n="IncorrectShortDateDMY"):[7,11,111].includes(e)?(a=ew.checkEuroDate,n="IncorrectDateDMY"):[13,16,116].includes(e)?(a=ew.checkShortUSDate,n="IncorrectShortDateMDY"):[6,10,110].includes(e)?(a=ew.checkUSDate,n="IncorrectDateMDY"):(a=ew.checkDateDef,n="IncorrectDate",i=ew.DATE_FORMAT),!(!a||a(r))&&{datetime:ew.language.phrase(n).replace(/%s/g,i)}}},time:function(e){var t=ew.getValue(e);return!ew.checkTime(t)&&{time:ew.language.phrase("IncorrectTime")}},float:function(e){var t=ew.getValue(e);return!ew.checkNumber(t)&&{time:ew.language.phrase("IncorrectFloat")}},range:function(e,t){return function(a){var n=ew.getValue(a);return!ew.checkRange(n,e,t)&&{range:ew.language.phrase("IncorrectRange").replace("%1",e).replace("%2",t)}}},integer:function(e){var t=ew.getValue(e);return!ew.checkInteger(t)&&{integer:ew.language.phrase("IncorrectInteger")}},phone:function(e){var t=ew.getValue(e);return!ew.checkPhone(t)&&{phone:ew.language.phrase("IncorrectPhone")}},zip:function(e){var t=ew.getValue(e);return!ew.checkZip(t)&&{zip:ew.language.phrase("IncorrectZip")}},creditCard:function(e){var t=ew.getValue(e);return!ew.checkCreditCard(t)&&{creditCard:ew.language.phrase("IncorrectCreditCard")}},ssn:function(e){var t=ew.getValue(e);return!ew.checkSsn(t)&&{ssn:ew.language.phrase("IncorrectSSN")}},guid:function(e){var t=ew.getValue(e);return!ew.checkGuid(t)&&{guid:ew.language.phrase("IncorrectGUID")}},regex:function(e){return function(t){var a=ew.getValue(t);return!ew.checkByRegEx(a,e)&&{regex:ew.language.phrase("IncorrectField")}}},custom:function(e){for(var t=arguments.length,a=new Array(t>1?t-1:0),n=1;n<t;n++)a[n-1]=arguments[n];return function(t){if("function"==typeof e){var n=ew.getValue(t);if(e.apply(void 0,[n].concat(a)))return{custom:ew.language.phrase("IncorrectField")}}return!1}},captcha:function(e){return!(!e||ew.hasValue(e))&&{captcha:ew.language.phrase("EnterValidateCode")}},recaptcha:function(e){var t;return!(!e||ew.hasValue(e)||""!==(null===(t=grecaptcha)||void 0===t?void 0:t.getResponse(e.dataset.id)))&&{recaptcha:ew.language.phrase("ClickReCaptcha")}}});function b(e,t){for(var a=0;a<t.length;a++){var n=t[a];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(e,n.key,n)}}var y=function(e,t,a){return t&&b(e.prototype,t),a&&b(e,a),e};var E=function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e};var _=function(e,t){e.prototype=Object.create(t.prototype),e.prototype.constructor=e,e.__proto__=t};var S=function(e,t,a){return t in e?Object.defineProperty(e,t,{value:a,enumerable:!0,configurable:!0,writable:!0}):e[t]=a,e};function x(t,a){var n=this;this._initiated=!1,this.id=t,this.pageId=a,this.$element=null,this.htmlForm=null,this.initSearchPanel=!1,this.modified=!1,this.validateRequired=!0,this.validate=null,this.emptyRow=null,this.multiPage=null,this.autoSuggests={},this.lists={},this.disableForm=function(){var t=this.getForm();e(t).find(":submit:not(.dropdown-toggle)").prop("disabled",!0).addClass("disabled")},this.enableForm=function(){var t=this.getForm(),a=e(t);a.find(".ew-disabled-element").removeClass("ew-disabled-element").prop("disabled",!1),a.find(".ew-enabled-element").removeClass("ew-enabled-element").prop("disabled",!0),a.find(":submit:not(.dropdown-toggle)").prop("disabled",!1).removeClass("disabled")},this.appendHidden=function(t){var a=this.getForm(),n=e(a),r=e(t).closest(".ew-form"),i=r.attr("id")+"$"+t.name;if(!n.find("input:hidden[name='"+i+"']")[0]){var o=r.find('[name="'+t.name+'"]').serializeArray();o.length?o.forEach((function(t,a){e('<input type="hidden" name="'+i+'">').val(t.value).appendTo(n)})):e('<input type="hidden" name="'+i+'">').val("").appendTo(n)}},this.canSubmit=function(){var t=this.getForm(),a=e(t);if(this.disableForm(),this.updateTextArea(),!this.validate||this.validate()&&!a.find(".is-invalid")[0]){a.find("input[name^=sv_], input[name^=p_], .ew-template input").prop("disabled",!0).addClass("ew-disabled-element"),a.find("[data-readonly=1][disabled]").prop("disabled",!1).addClass("ew-enabled-element");var r=e(a.find("input[name='detailpage']").map((function(e,t){return a.find("#"+t.value).get()})));return r.length>1&&r.each((function(t,a){e(a).find(":input").each((function(e,t){if(/^(fn_)?(x|o)\d*_/.test(t.name)){var i=r.not(a).find(":input[name='"+t.name+"']");i.length&&(n.appendHidden(t),i.each((function(){n.appendHidden(this)})))}}))})),!0}return this.enableForm(),!1},this.submit=function(e){var t=this.getForm();return this.canSubmit()&&(e&&(t.action=e),t.submit()),!1},this.getList=function(e){return e=e.replace(/^(sv_)?[xy](\d*|\$rowindex\$)_|\[\]$/g,""),this.lists[e]},this.compileTemplates=function(){for(var t=0,a=Object.values(this.lists);t<a.length;t++){var n=a[t];n.template&&e.isString(n.template)&&(n.template=e.templates(n.template))}},this.getForm=function(){return this.htmlForm||(this.$element=e("#"+this.id),this.$element.is("form")?this.htmlForm=this.$element[0]:this.$element.is("div")&&(this.htmlForm=this.$element.closest("form")[0])),this.htmlForm},this.getElement=function(t){return this.$element||(this.$element=e("#"+this.id)),t?ew.getElement(t,this.$element):this.$element[0]},this.getElements=function(t){this.$element||(this.$element=e("#"+this.id));var a="[name='"+t+"']";a="input"+a+",select"+a+",textarea"+a+",button"+a;var n=this.$element.find(a);return 0==n.length?null:1==n.length&&n.is(":not([type=checkbox]):not([type=radio])")?n[0]:n.get()},this.updateLists=function(t){if(null!==t&&(e.isNumber(t)||"grid"!=this.pageId)){var a=this.getForm(),r=a.querySelector("input#confirm");if(r&&"confirm"==r.value)ew.removeSpinner();else{var i=function(a,n){var r="",i=t,o=a.split(" ");o.length>1&&(r=o[0],i="",a=o[1]);var s=e.isNumber(i)?"x"+i+"_":"x_";return a=a.startsWith("x_")?a.replace(/^x_/,s):s+a,n&&!a.endsWith("[]")&&(a+="[]"),r?r+" "+a:a},o=Object.entries(this.lists).map((function(e){var t=e[0],a=e[1];return"[name='"+i(t,a.multiple)+"']"})).join();if(o&&a.querySelector(o)){var s=[],l=[];this.compileTemplates();for(var d=0,c=Object.entries(this.lists);d<c.length;d++){var u=c[d],p=u[0],f=u[1],h=f.parentFields.slice().map((function(e){return i(e)})),g=f.ajax;if(p=i(p,f.multiple),e.isBoolean(g)){var m=h.map((function(e){return ew.getOptionValues(e,a)}));s.push([p,m,g,!1])}else ew.updateOptions.call(this,p,h,null,!1)}for(var w=0;w<s.length;w++)l.push(new Promise((function(e,t){setTimeout((function(){e(ew.updateOptions.apply(n,s.shift()))}),ew.AJAX_DELAY*w)})));Promise.all(l).then((function(){e(document).trigger("updatedone",[{source:n,target:a}])})).catch((function(e){console.log(e)}))}else ew.removeSpinner()}}},this.createAutoSuggest=function(e){var t=Object.assign({limit:ew.AUTO_SUGGEST_MAX_ENTRIES,form:this},ew.autoSuggestSettings,e);n.autoSuggests[e.id]=new ew.AutoSuggest(t)},this.initEditors=function(){var t=this.getForm();e(t.elements).filter("textarea.editor").each((function(t,a){var n=e(a).data("editor");!n||n.active||n.name.includes("$rowindex$")||n.create()}))},this.updateTextArea=function(t){var a=this.getForm();e(a.elements).filter("textarea.editor").each((function(a,n){var r=e(n).data("editor");return!(r&&(!t||r.name==t))||(r.save(),!t&&void 0)}))},this.destroyEditor=function(t){var a=this.getForm();e(a.elements).filter("textarea.editor").each((function(a,n){var r=e(n).data("editor");return!(r&&(!t||r.name==t))||(r.destroy(),!t&&void 0)}))},this.onError=function(e,t){return ew.onError(this,e,t)},this.initUpload=function(){var t=this.getForm();e(t.elements).filter("input:file:not([name*='$rowindex$'],[id='importfiles'])").each((function(t){e.later(ew.AJAX_DELAY*t,null,ew.upload,this)}))},this.setupFilters=function(t,a){var r=this.id,i=this.filterList?this.filterList.data:null,o=e(".ew-save-filter[data-form="+r+"]").toggleClass("disabled",!i),s=e(".ew-delete-filter[data-form="+r+"]").toggleClass("disabled",!a.length).toggleClass("dropdown-toggle",!!a.length),l=s.parent("li").toggleClass("dropdown-submenu dropdown-hover",!!a.length).toggleClass("disabled",!a.length),d=o.parent("li").toggleClass("disabled",!i),c=(e(t.target),function(t,a){if("Client"==ew.SEARCH_FILTER_OPTION)window.localStorage.setItem(t+"_filters",JSON.stringify(a));else if("Server"==ew.SEARCH_FILTER_OPTION){var r=e("body");r.css("cursor","wait"),e.ajax(ew.currentPage(),{type:"POST",dataType:"json",data:{ajax:"savefilters",filters:JSON.stringify(a)}}).done((function(e){e[0]&&e[0].success&&(n.filterList.filters=a)})).always((function(){r.css("cursor","default")}))}});if(d.off("click.ew").on("click.ew",(function(e){if(d.hasClass("disabled"))return!1;ew.prompt(ew.language.phrase("EnterFilterName"),(function(e){(e=ew.sanitize(e))&&(a.push([e,i]),c(r,a))}),!0)})).prevAll().remove(),s.next("ul.dropdown-menu").remove(),a.length){var u=e("<ul class='dropdown-menu'></ul>");for(var p in a)Array.isArray(a[p])&&(e('<li><a class="dropdown-item" data-index="'+p+'" href="#" onclick="return false;">'+a[p][0]+"</a></li>").on("click",(function(t){var n=e(this).find("a[data-index]").data("index");ew.prompt(ew.language.phrase("DeleteFilterConfirm").replace("%s",a[n][0]),(function(e){e&&(a.splice(n,1),c(r,a))}))})).appendTo(u),e('<li><a class="dropdown-item ew-filter-list" data-index="'+p+'" href="#" onclick="return false;">'+a[p][0]+"</a></li>").insertBefore(d).on("click",(function(t){var n=e(this).find("a[data-index]").data("index");e("<form>").attr({method:"post",action:ew.currentPage()}).append(e("<input type='hidden'>").attr({name:"cmd",value:"resetfilter"}),e("<input type='hidden'>").attr({name:ew.TOKEN_NAME_KEY,value:ew.TOKEN_NAME}),e("<input type='hidden'>").attr({name:ew.ANTIFORGERY_TOKEN_KEY,value:ew.ANTIFORGERY_TOKEN}),e("<input type='hidden'>").attr({name:"filter",value:JSON.stringify(a[n][1])})).appendTo("body").submit()})));e("<li class='dropdown-divider'></li>").insertBefore(d),l.append(u)}},this.init=function(){if(!this._initiated){"Client"==ew.SEARCH_FILTER_OPTION&&window.localStorage||"Server"==ew.SEARCH_FILTER_OPTION&&ew.IS_LOGGEDIN&&!ew.IS_SYS_ADMIN&&""!=ew.CURRENT_USER_NAME?(e(".ew-filter-option."+this.id+" .ew-btn-dropdown").on("show.bs.dropdown",(function(t){var a=[];if("Client"==ew.SEARCH_FILTER_OPTION){var r=window.localStorage.getItem(n.id+"_filters");r&&(a=ew.parseJson(r)||[])}else"Server"==ew.SEARCH_FILTER_OPTION&&(a=n.filterList&&n.filterList.filters?n.filterList.filters:[]);var i=e.grep(a,(function(e){if(Array.isArray(e)&&2==e.length)return e}));n.setupFilters(t,i)})),e(".ew-filter-option").show()):e(".ew-filter-option").hide();var t=this.getForm(),a=e(t);if(t){this.compileTemplates();var r=/s(ea)?rch$/.test(this.id);r&&this.initSearchPanel&&!ew.hasFormData(t)&&e("#"+this.id+"-search-panel").removeClass("show"),e(".ew-search-toggle[data-form="+this.id+"]").on("click.bs.button",(function(){e("#"+e(this).data("form")+"-search-panel").collapse("toggle")})),e(".ew-table .ew-search-operator").text().trim()||e(".ew-table .ew-search-operator").parent("td").hide(),r&&e(".ew-highlight[data-form="+this.id+"]").on("click.bs.button",(function(){e("span."+e(this).data("name")).toggleClass("ew-highlight-search")})),r&&a.find("select[id^=z_]").each((function(){"BETWEEN"!=e(this).trigger("change").val()&&a.find("#w_"+this.id.substr(2)).trigger("change")})),this.multiPage&&this.multiPage.render(),loadjs.ready(["editor"],this.initEditors.bind(this)),this.updateLists(),this.initUpload(),this.$element.is("form")&&(this.$element.find(".ew-detail-pages .ew-nav-tabs a[data-toggle=tab]").on("shown.bs.tab",(function(t){var a=e(t.target.getAttribute("href")),n=a.find(".table-responsive.ew-grid-middle-panel"),r=a.closest(".container-fluid");n.width()>=r.width()?n.width(r.width()+"px"):n.width("auto")})),a.submit((function(e){return n.submit()})),a.find("[data-field], .ew-priv").on("change",(function(){ew.CONFIRM_CANCEL&&(n.modified=!0)})),a.find("#btn-cancel[data-href]").on("click",(function(){n.updateTextArea();var r=e(this).data("href");n.modified&&ew.hasFormData(t)?ew.prompt(ew.language.phrase("ConfirmCancel"),(function(e){e&&(a.find("#btn-action").prop("disabled",!0),window.location=r)})):(a.find("#btn-action").prop("disabled",!0),window.location=r)}))),this._initiated=!0,this.$element.data("form",this)}}},ew.forms.add(this)}function O(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function A(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?O(Object(a),!0).forEach((function(t){S(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):O(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function T(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"==typeof e)return I(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return I(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(a=e[Symbol.iterator]()).next.bind(a)}function I(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var C=function(){function e(e,t,a){if(S(this,"name",""),S(this,"validators",[]),S(this,"_validate",!0),this.name=e,Array.isArray(t))for(var n,r=T(t);!(n=r()).done;){var i=n.value;this.addValidator(i)}else"function"==typeof t&&this.addValidator(t);this.invalid=a}var t=e.prototype;return t.addValidator=function(e){"function"==typeof e&&this.validators.push(e)},t.addError=function(e){if(e){var t,a=null!==(t=this._error)&&void 0!==t?t:{};this._error=A(A({},a),e),this.invalid=!0}},t.clearErrors=function(){this._error=null,this.invalid=!1},t.clearValidators=function(){this.validators=[]},t.validate=function(){var e=!0;if(this.clearErrors(),this._element&&this.shouldValidate&&Array.isArray(this.validators)){for(var t,a=T(this.validators);!(t=a()).done;){var n=(0,t.value)(this._element);!1!==n&&(this.addError(n),e=!1)}this.updateFeedback()}return e},t.updateFeedback=function(){var e=this.errorMessage;this._element&&e&&(jQuery(this._element).closest("[id^=el_], .form-group").find(".invalid-feedback").html(e),ew.setInvalid(this._element))},t.focus=function(){this._element&&ew.setFocus(this._element)},y(e,[{key:"error",get:function(){return this._error}},{key:"errorMessage",get:function(){return this._error?Array.from(Object.values(this._error)).join("<br>"):""}},{key:"shouldValidate",get:function(){return!this._checkbox||this._checkbox.checked}},{key:"element",set:function(e){var t,a;this._element=e,this._checkbox=(null===(t=this._element)||void 0===t||null===(a=t.id)||void 0===a?void 0:a.match(/^[xy]_/))?document.getElementById(this._element.id.replace(/^[xy]_/,"u_")):null},get:function(){return this._element}},{key:"value",get:function(){return this._element?ew.getValue(this._element):""}}]),e}();function P(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function k(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?P(Object(a),!0).forEach((function(t){S(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):P(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}function R(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"==typeof e)return N(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return N(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(a=e[Symbol.iterator]()).next.bind(a)}function N(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}var L=function(e){function t(t,a){var n;return n=e.call(this,t,a)||this,S(E(n),"row",{}),S(E(n),"fields",{}),n}_(t,e);var a=t.prototype;return a.addField=function(e,t,a){e in this.fields||(this.fields[e]=new C(e,t,a))},a.getField=function(e){return this.fields[e]},a.addFields=function(e){if(Array.isArray(e))for(var t,a=R(e);!(t=a()).done;){var n=t.value;Array.isArray(n)&&this.addField.apply(this,n)}},a.addError=function(e,t){var a;t&&(this._error=null!==(a=this._error)&&void 0!==a?a:{},this._error[e]=t)},a.addCustomError=function(e,t){if(e in this.fields){var a=this.fields[e],n={custom:t};a.addError(n),a.updateFeedback(),this.addError(e,n)}return!1},a.focus=function(){for(var e=0,t=Object.entries(this.fields);e<t.length;e++){var a=t[e],n=a[0],r=a[1];if(r.invalid||this._error&&this._error[n]){r.focus(),this.makeVisible(r.element);break}}},a.makeVisible=function(e){if(this.multiPage)this.multiPage.gotoPageByElement(e);else if(this.$element.is("div")){var t=this.$element.closest(".tab-pane");t[0]&&!t.hasClass("active")&&t.closest(".tabbable, .ew-nav-tabs").find("a[data-toggle=tab][href='#"+t.attr("id")+"']").click()}},a.validateFields=function(e){this.rowIndex=null!=e?e:"",this.row={},this._error=null;for(var t=!0,a=0,n=Object.values(this.fields);a<n.length;a++){var r=n[a];r.element=this.getElements("x"+this.rowIndex+"_"+r.name),r.element||(r.element=this.getElements("x"+this.rowIndex+"_"+r.name+"[]")),r.element||(r.element=this.getElements(r.name)),this.row[r.name]=r.value,r.validate()||(this.addError(r.name,r.error),t=!1)}if(this.value){Array.isArray(this.value)||(this.value=[this.value]);var i=parseInt(e,10)||0;i=i>1?i-1:0,this.value[i]=k({},this.row)}else this.value=k({},this.row);return this.focus(),t},a.setInvalid=function(e){this.rowIndex=null!=e?e:"";for(var t=0,a=Object.values(this.fields);t<a.length;t++){var n=a[t];n.invalid&&(n.element=this.getElements("x"+this.rowIndex+"_"+n.name),n.element||(n.element=this.getElements("x"+this.rowIndex+"_"+n.name+"[]")),n.element||(n.element=this.getElements(n.name)),ew.setInvalid(n.element))}},y(t,[{key:"error",get:function(){return this._error}}]),t}(x),D=function(){function t(t){S(this,"_isAutoSuggest",null),this.elementId=t.id,this.form=t.form,e.isString(this.form)&&(this.form=ew.forms.get(this.form)),this.element=this.form.getElement(this.elementId),this.formElement=this.form.getElement(),this.list=this.form.getList(this.elementId);var a=this.elementId.match(/^[xy](\d*|\$rowindex\$)_/),n=a?a[1]:"";this.parentFields=this.list.parentFields.slice().map((function(e){return 1==e.split(" ").length?e.replace(/^x_/,"x"+n+"_"):e})),this.limit=t.limit,this.debounce=t.debounce,this.data=t.data,this.recordCount=0}var a=t.prototype;return a.formatResult=function(e){return this.list.template&&!this.isAutoSuggest?this.list.template.render(e,ew.jsRenderHelpers):ew.displayValue(e,this.element)||e[0]},a.generateRequest=function(){var e=this,t=Object.assign({},this.data,{name:this.element.name,page:this.list.page,field:this.list.field,ajax:"autosuggest",language:ew.LANGUAGE_ID},ew.getUserParams("#p_"+this.elementId,this.formElement));return this.parentFields.length>0&&this.parentFields.forEach((function(a,n){var r=ew.getOptionValues(a,e.formElement);t["v"+(n+1)]=r.join(ew.MULTIPLE_OPTION_SEPARATOR)})),t},a.getUrl=function(t,a){var n=new URLSearchParams({q:t,n:this.limit,rnd:ew.random(),start:e.isNumber(a)?a:-1});return ew.getApiUrl(ew.API_LOOKUP_ACTION,n.toString())},a.prepare=function(e,t){return{url:this.getUrl(e,t),type:"POST",dataType:"json",data:this.generateRequest()}},a.transform=function(e){var t=[];return e&&"OK"==e.result&&(this.recordCount=e.totalRecordCount,t=e.records),t},y(t,[{key:"isAutoSuggest",get:function(){return null===this._isAutoSuggest&&(this._isAutoSuggest=ew.isAutoSuggest(this.element)),this._isAutoSuggest}}]),t}(),j=function(e,t,a){this.value=String(e||""),this.text=String(t||""),this.selected=!!a};function M(t){D.call(this,t);var a={typeahead:{}};if(this.elementId.includes("$rowindex$"))return a;if(this.input=this.form.getElement("sv_"+this.elementId),!this.input)return a;var n,r=this,i=e(this.input),o=e(this.element);this.minWidth=t.minWidth,this.maxHeight=t.maxHeight,this.highlight=t.highlight,this.hint=t.hint,this.minLength=t.minLength,this.templates=Object.assign({},t.templates),this.trigger=t.trigger,this.delay=t.delay,this.debounce=t.debounce,this.display=t.display||"text",this.forceSelection=t.forceSelect,this.$input=i,this.$element=o,i.val()&&o.val()&&this.element.add(o.val(),i.val(),!0),this.setValue=function(e){e=e||i.val();var t=this.element.options.findIndex((function(t){return t.text==e}));if(t<0){if(this.forceSelection&&e)return i.typeahead("val","").attr("placeholder",ew.language.phrase("ValueNotExist")).addClass("is-invalid"),void o.val("").trigger("change")}else this.element.options[t].selected=!0,/s(ea)?rch$/.test(this.formElement.id)&&!this.forceSelection||(e=this.element.options[t].value);e!==o.attr("value")&&o.attr("value",e).trigger("change")},this.transform=function(e){var t=D.prototype.transform.call(this,e);return this.element.options=t.map((function(e){return new j(e[0],r.formatResult(e))})),this.element.options},this.source=function(t,a,i){n&&n.cancel(),n=e.later(r.debounce,null,(function(){r.recordCount=0;var a=r.prepare(t);e.ajax(a).done((function(e){i(r.transform(e))}))}))},this.count=function(){return r.typeahead.menu.$node.find(".tt-suggestion.tt-selectable").length},this.more=function(){var t=e("body");t.css("cursor","wait");var a=r.typeahead,n=a.menu.query,i=a.menu.datasets[0],o=r.count(),s=r.prepare(n,o);e.ajax(s).done((function(e){e=r.transform(e),i._append(n,e),a.menu.$node.find(".tt-dataset").scrollTop(i.$lastSuggestion.outerHeight()*o)})).always((function(){t.css("cursor","default")}))},i.on("typeahead:select",(function(e,t){r.setValue(t[r.display])})).change((function(e){var t=i.data("tt-typeahead");if(t&&t.isOpen()&&!t.menu.empty()){var a=t.menu.getActiveSelectable();if(a){var n=a.index(),o=r.element.options[n].text;i.typeahead("val",o)}}r.setValue()})).blur((function(e){var t=i.data("tt-typeahead");t&&t.isOpen()&&t.menu.close()})).focus((function(e){i.attr("placeholder",i.data("placeholder")).removeClass("is-invalid")}));var s=r.list.template||r.templates.suggestion;s&&e.isString(s)&&(s=e.templates(s)),s&&(r.templates.suggestion=s.render.bind(s)),o.data("autosuggest",this),e((function(){var e={highlight:r.highlight,minLength:r.minLength,hint:r.hint,trigger:r.trigger,delay:r.delay},t={name:r.form.id+"-"+r.elementId,source:r.source,templates:r.templates,display:r.display,limit:r.limit,async:!0},a=[e,t];o.trigger("typeahead",[a]),r.limit=t.limit,i.typeahead.apply(i,a),i.on("typeahead:rendered",(function(){var t=r.typeahead.menu.$node,a=t.find(".tt-more").html(ew.language.phrase("More"));arguments.length>1&&r.recordCount>r.count()?a.one(e.trigger,(function(t){setTimeout((function(){r.more()}),e.delay),t.preventDefault(),t.stopPropagation()})):a.hide()})),i.off("blur.tt"),r.typeahead=i.data("tt-typeahead");var n=r.typeahead.menu.$node.css("z-index",1e3);r.minWidth&&n.css("min-width",r.minWidth);var s=n.find(".tt-dataset"),l=r.maxHeight||(parseInt(s.css("line-height"),10)+6)*(t.limit+1);s.css({"max-height":l,"overflow-y":"auto"})}))}M.prototype=Object.create(D.prototype);var F=function(){function t(){S(this,"_forms",{})}var a=t.prototype;return a.get=function(t){var a=e.isString(t)?t:ew.getForm(t).id;return this._forms[a]},a.add=function(e){this._forms[e.id]=e},a.ids=function(){return Object.keys(this._forms)},t}();function U(e,t){var a;if("undefined"==typeof Symbol||null==e[Symbol.iterator]){if(Array.isArray(e)||(a=function(e,t){if(!e)return;if("string"==typeof e)return $(e,t);var a=Object.prototype.toString.call(e).slice(8,-1);"Object"===a&&e.constructor&&(a=e.constructor.name);if("Map"===a||"Set"===a)return Array.from(e);if("Arguments"===a||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(a))return $(e,t)}(e))||t&&e&&"number"==typeof e.length){a&&(e=a);var n=0;return function(){return n>=e.length?{done:!0}:{done:!1,value:e[n++]}}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}return(a=e[Symbol.iterator]()).next.bind(a)}function $(e,t){(null==t||t>e.length)&&(t=e.length);for(var a=0,n=new Array(t);a<t;a++)n[a]=e[a];return n}function B(e,t){var a=Object.keys(e);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(e);t&&(n=n.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),a.push.apply(a,n)}return a}function Y(e){for(var t=1;t<arguments.length;t++){var a=null!=arguments[t]?arguments[t]:{};t%2?B(Object(a),!0).forEach((function(t){S(e,t,a[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(a)):B(Object(a)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(a,t))}))}return e}var H,V=new URL(window.location),K=new F,G=e(document),z=e("body"),W=ew.removeSpinner;function q(t){var a=t&&t.target?t.target:document;e(a).find(".ew-icon").closest("a, button").add(".ew-tooltip").tooltip({container:"body",trigger:ew.IS_MOBILE?"manual":"hover",placement:"bottom",sanitizeFn:ew.sanitizeFn})}function J(t){var a=t&&t.target?t.target:document;e.fn.pStrength&&"undefined"!=typeof ew.MIN_PASSWORD_STRENGTH&&e(a).find(".ew-password-strength").each((function(){var t=e(this);t.data("pStrength")||t.pStrength({changeBackground:!1,backgrounds:[],passwordValidFrom:ew.MIN_PASSWORD_STRENGTH,onPasswordStrengthChanged:function(t,a){var n=e(this),r=e("[id='"+n.attr("data-password-strength")+"']"),i=r.find(".progress-bar");if(r.width(n.outerWidth()),n.val()&&!ew.isMaskedPassword(this)){var o=a+"%";a<25?i.addClass("bg-danger").removeClass("bg-warning bg-info bg-success"):a<50?i.addClass("bg-warning").removeClass("bg-danger bg-info bg-success"):a<75?i.addClass("bg-info").removeClass("bg-danger bg-warning bg-success"):i.addClass("bg-success").removeClass("bg-danger bg-warning bg-info"),i.css("width",o),a>25&&(o=ew.language.phrase("PasswordStrength").replace("%p",o)),i.html(o),r.removeClass("d-none").show(),n.data("validated",a>=ew.MIN_PASSWORD_STRENGTH)}else r.addClass("d-none").hide(),n.data("validated",null)}})})),e.fn.pGenerator&&e(a).find(".ew-password-generator").each((function(){var t=e(this);t.data("pGenerator")||t.pGenerator({passwordLength:ew.GENERATE_PASSWORD_LENGTH,uppercase:ew.GENERATE_PASSWORD_UPPERCASE,lowercase:ew.GENERATE_PASSWORD_LOWERCASE,numbers:ew.GENERATE_PASSWORD_NUMBER,specialChars:ew.GENERATE_PASSWORD_SPECIALCHARS,onPasswordGenerated:function(t){var a=e(this);e("#"+a.attr("data-password-field")).val(t).trigger("change").trigger("focus").triggerHandler("click"),e("#"+a.attr("data-password-confirm")).val(t),e("#"+a.attr("data-password-strength")).addClass("d-none").hide()}})}))}function X(t,a){var n=ew.PATH_BASE+ew.API_URL,r=new URLSearchParams(a);if(ew.USE_URL_REWRITE){if(e.isString(t))n+=t||"";else if(Array.isArray(t)){var i=t.map((function(e){return encodeURIComponent(e)})).join("/");n+=i||""}}else t&&r.set(ew.API_ACTION_NAME,t);var o=r.toString();return n+(o?"?"+o:"")}function Q(e){var t=e.split("?"),a=t[1];if(a){var n=new URLSearchParams(a);n.forEach((function(e,t){return n.set(t,ew.sanitize(e))})),a=n.toString()}return t[0]+(a?"?"+a:"")}function Z(t){var a=t&&t.target?t.target:document;e(a).find(".ew-export-link[href]:not(.ew-email):not(.ew-print):not(.ew-xml)").on("click",(function(t){var a=e(this).attr("href");a&&"#"!=a&&te(a),t.preventDefault()}))}function ee(t){var a=t&&t.target?t.target:document,n=e(a),r=n.find("input[type=checkbox].ew-multi-select"),i=function(e){var t=r.filter("[name^='"+e+"_']"),a=t.length,n=t.filter(":checked").length;t.closest("form").find("input[type=checkbox]#"+e).prop("checked",n==a).prop("indeterminate",n!=a&&0!=n)};r.on("click",(function(e){i(this.name.split("_")[0])})),n.find("input[type=checkbox].ew-priv:not(.ew-multi-select)").each((function(){i(this.id)}))}function te(e,t){var a=window.parent,n=a.jQuery,r=a.Swal,i=a.document,o=n(i),s=t?"POST":"GET",l=e.includes("export=html");return r.fire(Y(Y({},ew.sweetAlertSettings),{},{html:"<p>"+ew.language.phrase("Exporting")+"</p>",allowOutsideClick:!1,allowEscapeKey:!1,onBeforeOpen:function(){r.showLoading(),n.ajax({url:e,type:s,cache:!1,data:t||null,xhrFields:{responseType:l?"text":"blob"}}).done((function(t,n,s){var d=a.URL.createObjectURL(l?new Blob([t],{type:"text/html"}):t),c=i.createElement("a"),u=s.getResponseHeader("Content-Disposition").match(/\bfilename=((['"])(.+)\2|([^;]+))/i);c.style.display="none",c.href=d,u&&(c.download=u[3]||u[4]),i.body.appendChild(c),c.click(),o.trigger("export",[{type:"done",url:e,objectUrl:d}]),a.URL.revokeObjectURL(d),r.close()})).fail((function(){r.showValidationMessage("<div class='text-danger'><h4>"+ew.language.phrase("FailedToExport")+"</h4>"+response+"</div>"),o.trigger("export",[{type:"fail",url:e}])})).always((function(){o.trigger("export",[{type:"always",url:e}])}))}}))}function ae(t){if(ew.LAZY_LOAD){var a=t&&t.target?t.target:document;e(a).find("img.ew-lazy").each((function(){this.src=this.dataset.src})),G.trigger("lazyload")}}function ne(t){if(ew.USE_COLORBOX){var a=t&&t.target?t.target:document,n=Object.assign({},ew.lightboxSettings,{title:ew.language.phrase("LightboxTitle"),current:ew.language.phrase("LightboxCurrent"),previous:ew.language.phrase("LightboxPrevious"),next:ew.language.phrase("LightboxNext"),close:ew.language.phrase("LightboxClose"),xhrError:ew.language.phrase("LightboxXhrError"),imgError:ew.language.phrase("LightboxImgError")});e(a).find(".ew-lightbox").each((function(){var t=e(this);t.colorbox(Object.assign({rel:t.data("rel")},n))}))}}function re(t){if(ew.EMBED_PDF){var a=t&&t.target?t.target:document,n=Object.assign({},ew.PDFObjectOptions);e(a).find(".ew-pdfobject").not(":has(.pdfobject)").each((function(){var t=e(this),a=t.data("url"),r=t.html();a&&PDFObject.embed(a,this,Object.assign(n,{fallbackLink:r}))}))}}function ie(t){var a=t&&t.target?t.target:document,n=e(a);n.find("input[data-toggle=tooltip],textarea[data-toggle=tooltip],select[data-toggle=tooltip]").each((function(){var t=e(this);t.tooltip(Object.assign({html:!0,placement:"bottom",sanitizeFn:ew.sanitizeFn},t.data()))})),n.find("a.ew-tooltip-link").each(Ze),n.find(".ew-tooltip").tooltip({placement:"bottom",sanitizeFn:ew.sanitizeFn}),n.find(".ew-popover").popover({sanitizeFn:ew.sanitizeFn})}function oe(t){if(e.isString(t))try{return JSON.parse(t)}catch(e){return}return t}function se(t,a,n,r){return n?Swal.fire(Y(Y({},ew.sweetAlertSettings),{},{html:t,input:"text",confirmButtonText:ew.language.phrase("OKBtn"),showCancelButton:e.isFunction(a),cancelButtonText:ew.language.phrase("CancelBtn"),inputValidator:r||function(e){if(!e)return ew.language.phrase("EnterValue")}})).then((function(t){e.isFunction(a)&&a(t.value)})):Swal.fire(Y(Y({},ew.sweetAlertSettings),{},{html:"<div>"+t+"</div>",confirmButtonText:ew.language.phrase("OKBtn"),showCancelButton:e.isFunction(a),cancelButtonText:ew.language.phrase("CancelBtn")})).then((function(t){e.isFunction(a)&&a(t.value)}))}function le(t){t=Object.assign({},ew.toastOptions,t),G.Toasts("create",t);var a=t.position;return e("#toastsContainer"+a[0].toUpperCase()+a.substring(1)).children().first()}function de(e,t){return le({class:"ew-toast bg-"+(t=t||"danger"),title:ew.language.phrase(t),body:e,autohide:"success"==t&&ew.autoHideSuccessMessage,delay:"success"==t?ew.autoHideSuccessMessageDelay:500})}function ce(t){if(t instanceof L)return t.$element[0];var a=e(t),n=a.closest(".ew-form");return n[0]||(n=a.closest(".ew-grid, .ew-multi-column-grid").find(".ew-form").not(".ew-pager-form")),n[0]}function ue(t,a,n,r){var i=this.$element?this.$element[0]:this.form?this.form:null;if(i&&((this.htmlForm?this:K.get(i.id))&&(this.form&&e.isUndefined(t)?t=K.get(this).getList(this.name).childFields.slice():e.isString(t)&&(t=Ce(t,i)),t&&(!Array.isArray(t)||0!=t.length)))){var o=this,s=Promise.resolve();if(Array.isArray(t)&&e.isString(t[0])){for(var l=[],d=0,c=t.length;d<c;d++){var u=t[d].split(" ");if(1==u.length&&o.form){var p=Me(o,!1).match(/^([xy]\d*_)/);p&&(t[d]=t[d].replace(/^([xy]\d*_)/,p[1]))}var f=Ce(t[d],i),h=[];if(l.push(f),2==u.length&&Array.isArray(f)){var g=e(f);g.each((function(){if(!h.includes(this.name)){h.push(this.name);var e=g.filter("[name='"+this.name+"']"),t=e.attr("type"),i=["radio","checkbox"].includes(t)?e.get():e[0];s=s.then(pe.bind(o,i,a,n,r))}}))}else s=s.then(pe.bind(o,f,a,n,r))}t=l;var m=K.get(o).getList(o.name);m&&Array.isArray(m.autoFillTargetFields)&&m.autoFillTargetFields[0]&&(s=s.then(Qe.bind(null,o)))}else s=s.then(pe.bind(o,t,a,n,r));return s.then((function(){G.trigger("updatedone",[{source:o,target:t}])}))}}function pe(t,a,n,r){var i=Me(t,!1);if(i){var o=ce(t);if(o&&o.id){var s=K.get(o.id);if(s){var l=this,d=Array.from(arguments),c=Le(t),u=i.match(/^([xy])(\d*)_/),p=u?u[1]:"",f=u?u[2]:"",h=[],g=s.getList(i),m=e(t).data("updating",!0);if(!m.data("hidden")){if(e.isUndefined(a)&&(a=g.parentFields.slice(),""!=f))for(var w=0,v=a.length;w<v;w++){var b=a[w].split(" ");1==b.length&&(a[w]=a[w].replace(/^x_/,"x"+f+"_"))}if(Array.isArray(a)&&a.length>0)if(Array.isArray(a[0]))h=a;else if(e.isString(a[0]))for(w=0,v=a.length;w<v;w++)h.push(Le(a[w],o));ve(t)||je(t);var y=function(e){var a=Me(t);e.forEach((function(e){var n={data:e,parents:h,valid:!0,name:a,form:o};G.trigger("addoption",[n]),n.valid&&Ye(t,e,o)})),t.list&&t.render(),He(t,c),!1!==r&&(!t.options&&t.length?m.first().triggerHandler("click"):m.first().trigger("change"))};e.isUndefined(n)&&(n=g.ajax);var E=function(){/s(ea)?rch$/.test(o.id)&&"x"==p&&(d[0]=i.replace(/^x_/,"y_"),ue.apply(l,d))};if(!e.isBoolean(n)||Array.isArray(g.lookupOptions)&&g.lookupOptions.length>0){var _=g.lookupOptions;return y(_),E(),_}var S=Me(t),x=Object.assign({page:g.page,field:g.field,ajax:"updateoption",language:ew.LANGUAGE_ID,name:S},fe("#p_"+i,o));ve(t)&&l.htmlForm?x.v0=c[0]||wt():we(t)&&(x.v0=c[0]?t.multiple?c.join(ew.MULTIPLE_OPTION_SEPARATOR):c[0]:wt());w=0;for(var O=h.length;w<O;w++)x["v"+(w+1)]=h[w].join(ew.MULTIPLE_OPTION_SEPARATOR);return e.ajax(X(ew.API_LOOKUP_ACTION),{type:"POST",dataType:"json",data:x,async:n}).done((function(e){var a=e.records||[];return y(a),E(),m.first().trigger("updated",[Object.assign({},e,{target:t})]),a})).always((function(){return m.data("updating",!1)}))}}}}}function fe(t,a){t=t.replace(/\[\]$/,"");var n={},r=((a=e.isString(a)?/^#/.test(a)?a:"#"+a:a)?e(a).find(t):e(t)).val();r&&new URLSearchParams(r).forEach((function(e,t){n[t]=e}));return n}function he(e){return e&&["1","y","t","true"].includes(e.toLowerCase())}function ge(t,a,n,r,i,o){if(!t)return!1;var s=e(t),l=s.attr("target"),d=s.attr("action"),c=i&&s.find("input[type=checkbox][name='key_m[]']")[0];if(c&&!Ee(t))return be(ew.language.phrase("NoRecordSelected")),!1;if(r)if(e("iframe.ew-export").remove(),"email"==n&&(a+=("&"+e(o).serialize()).replace(/&export=email/i,"")),c){e("<iframe>").attr("name","ew-export-frame").addClass("ew-export d-none").appendTo(z);try{s.append(e("<input type='hidden'>").attr({name:"custom",value:"1"})).attr({action:a,target:"ew-export-frame"}).find("input[name=exporttype]").val(n).end().submit()}finally{s.attr({target:l||"",action:d}).find("input[name=custom]").remove()}}else e("<iframe>").attr({name:"ew-export-frame",src:a}).addClass("ew-export d-none").appendTo(z);else s.find("input[name=exporttype]").val(n),["xml","print"].includes(n)?s.submit():te(d,s.serialize());return!1}function me(t){var a=e(t);return a.is(":hidden")&&a.data("editor")}function we(t){var a=e(t);return a.is(":hidden")&&a.data("lookup")}function ve(t){var a=e(t);return a.is(":hidden")&&a.data("autosuggest")}function be(t,a,n){return Swal.fire(Y(Y({},ew.sweetAlertSettings),{},{html:'<p class="text-'+(n||"danger")+'">'+t+"</p>",confirmButtonText:ew.language.phrase("OKBtn")})).then((function(t){e.isFunction(a)&&a(t.value)}))}function ye(t){if(t){var a=e(t);if(!Re(a)){if(me(t))return a.data("editor").focus();if(we(t))return a.parent().find(".ew-lookup-text").trigger("focus");!t.options&&t.length?t=a[0]:ve(t)&&(t=t.input),e(t).trigger("focus")}}}function Ee(t){return e(t).find("input[type=checkbox][name='key_m[]']:checked",t).length>0}function _e(t){t&&t.form&&e(t.form.elements).filter("input[type=checkbox][name^="+t.name+"_], [type=checkbox][name="+t.name+"]").not(t).not(":disabled").prop("checked",t.checked)}function Se(t,a){var n=e(a),r=n.closest(".ew-table");r[0]&&(n.data("selected")?n.removeClass(r.data("rowhighlightclass")||"ew-table-highlight-row").removeClass(r.data("roweditclass")||"ew-table-edit-row").addClass(r.data("rowselectclass")||"ew-table-select-row"):[ew.ROWTYPE_ADD,ew.ROWTYPE_EDIT].includes(n.data("rowtype"))?n.removeClass(r.data("rowselectclass")||"ew-table-select-row").removeClass(r.data("rowhighlightclass")||"ew-table-highlight-row").addClass(r.data("roweditclass")||"ew-table-edit-row"):n.removeClass(r.data("rowselectclass")||"ew-table-select-row").removeClass(r.data("roweditclass")||"ew-table-edit-row").removeClass(r.data("rowhighlightclass")||"ew-table-highlight-row"))}function xe(t){e(t.rows).each((function(t,a){var n=e(a);!n.data("checked")&&n.data("selected")&&(n.data("selected",!1),Se(0,a))}))}function Oe(t){var a=e(t);if(a.closest(".ew-table")[0]){var n=a.closest(".ew-table > tbody > tr");n.siblings("[data-rowindex='"+n.data("rowindex")+"']").addBack().each((function(t,a){var n=e(a);n.data("selected",n.data("checked"))}))}}function Ae(t){var a=e(t),n=a.closest(".ew-table")[0];if(n){xe(n);var r=a.closest(".ew-table > tbody > tr");r.siblings("[data-rowindex='"+r.data("rowindex")+"']").addBack().each((function(t,a){e(a).data("selected",!0),Se(0,a)}))}}function Te(t,a,n){var r=e(a),i=e(a.rows);if(a&&a.rows&&(n||!r.data("isset"))&&0!=a.tBodies.length){var o=function(t){var a=e(this);if(!a.data("selected")&&![ew.ROWTYPE_ADD,ew.ROWTYPE_EDIT].includes(a.data("rowtype"))){var n=a.closest(".ew-table");if(!n[0])return;a.siblings("[data-rowindex='"+a.data("rowindex")+"']").addBack().each((function(t,a){e(a).addClass(n.data("rowhighlightclass")||"ew-table-highlight-row")}))}},s=function(t){var a=e(this);a.data("selected")||[ew.ROWTYPE_ADD,ew.ROWTYPE_EDIT].includes(a.data("rowtype"))||a.siblings("[data-rowindex='"+a.data("rowindex")+"']").addBack().each(Se)},l=function(t){var a=e(this),n=a.closest(".ew-table")[0],r=e(t.target);if(n&&!r.hasClass("btn")&&!r.hasClass("ew-preview-row-btn")&&!r.is(":input")&&!a.data("checked")){var i=a.data("selected");xe(n),a.siblings("[data-rowindex='"+a.data("rowindex")+"']").addBack().each((function(t,a){e(a).data("selected",!i),Se(0,a)}))}},d=i.filter("[data-rowindex=1]").length||i.filter("[data-rowindex=0]").length||1,c=i.filter(":not(.ew-template)").each((function(){e(this.cells).removeClass("ew-table-last-row").last().addClass("ew-table-last-col")})).get(),u=r.parentsUntil(".ew-grid","."+ew.RESPONSIVE_TABLE_CLASS)[0];if(c.length)for(var p=1;p<=d;p++){var f=c[c.length-p];e(f.cells).each((function(){this.rowSpan==p&&e(this).addClass("ew-table-last-row").toggleClass("ew-table-border-bottom",!!u&&u.clientHeight>a.offsetHeight)}))}var h=r.closest("form")[0],g=h&&e(h.elements).filter("input#action:not([value^=grid])").length>0;e(a.tBodies[a.tBodies.length-1].rows).filter(":not(.ew-template):not(.ew-table-preview-row)").each((function(t){var a=e(this);g&&!a.data("isset")&&([ew.ROWTYPE_ADD,ew.ROWTYPE_EDIT].includes(a.data("rowtype"))&&a.on("mouseover",(function(){this.edit=!0})).addClass("ew-table-edit-row"),a.on("mouseover",o).on("mouseout",s).on("click",l),a.data("isset",!0));var n=t%(2*d)<d;a.toggleClass("ew-table-row",n).toggleClass("ew-table-alt-row",!n)})),Ie(t,r.closest(".ew-grid")[0],n),r.data("isset",!0)}}function Ie(t,a,n){var r=e(a);!a||!n&&r.data("isset")||(0!=(r.find("table.ew-multi-column-table").length?r.find("td[data-rowindex]").length:r.find("table.ew-table > tbody").first().children("tr:not(.ew-table-preview-row, .ew-template)").length)||r.find(".ew-grid-upper-panel, .ew-grid-lower-panel")[0]||r.hide(),r.find(".ew-grid-middle-panel:visible").hasClass(ew.RESPONSIVE_TABLE_CLASS)&&r.width()>e(".content").width()&&(r.addClass("d-flex"),r.closest(".ew-detail-pages").addClass("d-block"),r.closest(".ew-form").addClass("w-100"),ew.USE_OVERLAY_SCROLLBARS&&r.find(".ew-grid-middle-panel:not(.ew-preview-middle-panel)").overlayScrollbars(ew.overlayScrollbarsOptions)),r.data("isset",!0))}function Ce(t,a){var n;if(e.isObject(t)&&t.dataset)n="[data-table='"+t.dataset.table+"'][data-field='"+t.dataset.field+"']:not([name^=o]):not([name^='x$'])";else if(e.isString(t)){n="[name='"+t+"']";var r=t.split(" ");2==r.length&&(n="[data-table='"+r[0]+"'][data-field='"+Me(r[1])+"']:not([name^=o]):not([name^='x$'])")}n="input"+n+",select"+n+",textarea"+n+",button"+n;var i=(a=e.isString(a)?/^#/.test(a)?a:"#"+a:a)?e(a).find(n):e(n);return 1==i.length&&i.is(":not([type=checkbox]):not([type=radio])")?i[0]:i.get()}function Pe(t,a){a=e.isString(a)?"#"+a:a;var n="#"+t.replace(/([\$\[\]])/g,"\\$1")+",[name='"+t+"']";return a?e(a).find(n)[0]:e(n).first()[0]}function ke(e,t){for(;e=e.parentNode;)if(e&&1==e.nodeType&&(!t||t(e)))return e;return null}function Re(t){var a=e(t);return"none"==a.css("display")&&!a.closest(".dropdown-menu")[0]&&!we(t)&&!ve(t)&&!me(t)||null!=ke(t,(function(e){return"none"==e.style.display&&!e.classList.contains("tab-pane")&&!e.classList.contains("collapse")}))}function Ne(e,t){return String(e).toLowerCase()==String(t).toLowerCase()}function Le(t,a){var n;e.isString(t)?n=2==t.split(" ").length?Ce(t):Ce(t,a):n="radio"==t.type||"checkbox"==t.type?Ce(t):t;if(n.options)return n.list?n.values:Array.prototype.filter.call(n.options,(function(e){return e.selected&&""!==e.value})).map((function(e){return e.value}));if(e.isNumber(n.length))return e(n).filter(":checked").map((function(){return this.value})).get();if(ew.isHiddenTextArea(n))return e(n).data("editor").save(),[n.value];var r=e(n).data();return r.lookup&&r.multiple?n.value.split(ew.MULTIPLE_OPTION_SEPARATOR):[n.value]}function De(t,a){var n;e.isString(t)?n=2==t.split(" ").length?Ce(t):Ce(t,a):n=t;return ve(n)?[n.input.value]:we(n)?e(n).parent().find(".ew-lookup-text .ew-option").map((function(){return e(this).text().trim()})).get():n.options?Array.prototype.filter.call(n.options,(function(e){return e.selected&&""!==e.value})).map((function(e){return e.text})):e.isNumber(n.length)?e(n).filter(":checked").map((function(){return e(this).parent().text()})).get():ew.isHiddenTextArea(n)?(e(n).data("editor").save(),[n.value]):[n.value]}function je(e){if(e.options){var t="select-multiple"==e.type||e.hasAttribute("data-dropdown")||!1===he(e.getAttribute("data-pleaseselect"))||e.length>0&&""!=e.options[0].value?0:1;if(e.list)e.removeAll();else for(var a=e.length-1;a>=t;a--)e.remove(a);ve(e)&&(e.input.value="",e.value="")}}function Me(t,a){var n=e.isString(t)?t:e(t).attr("name")||e(t).attr("id");return!1!==a?n.replace(/\[\]$/,""):n}function Fe(t,a){var n=e(a).data("value-separator");return Array.isArray(n)?n[t-1]:n||", "}function Ue(t,a){for(var n=t.df,r=2;r<=4;r++)if(t["df"+r]&&""!=t["df"+r]){var i=Fe(r-1,a);if(e.isUndefined(i))break;e.isValue(n)&&(n+=i),n+=t["df"+r]}return n}function $e(e){return ew.OPTION_HTML_TEMPLATE.replace(/\{value\}/g,e)}function Be(e,t){if(e.length>(t||ew.MAX_OPTION_COUNT))return ew.language.phrase("CountSelected").replace("%s",e.length);if(e.length){for(var a="",n=0;n<e.length;n++)a+=$e(e[n]);return a}return ew.language.phrase("PleaseSelect")}function Ye(e,t,a){var n,r=K.get(a.id),i=Me(e),o=r.getList(i),s=t.lf,l={lf:t.lf,df1:t.df,df2:t.df2,df3:t.df3,df4:t.df4};n=o.template&&!ve(e)?o.template.render(l,ew.jsRenderHelpers):Ue(t,e)||s;var d,c={data:l,name:i,form:a.$element,value:s,text:n};e.options&&(e.list?d=new j(c.value,c.text):((d=document.createElement("option")).value=c.value,d.innerHTML=c.text),c=Y(Y({},c),{},{option:d}),G.trigger("newoption",[c]),e.list?e.add(c.option.value,c.option.text):e.add(c.option));return c.text}function He(t,a){if(t&&a){var n=e(t);if(Array.isArray(a))if(t.options){if(t.list?t.value=a:(n.val(a),"select-one"==t.type&&-1==t.selectedIndex&&(t.selectedIndex=0)),ve(t)&&1==a.length)for(var r,i=U(t.options||[]);!(r=i()).done;){var o=r.value;if(o.value==a[0]){t.value=o.value,t.input.value=o.text;break}}else if(we(t)){for(var s,l=[],d=[],c=t.options||[],u=U(a);!(s=u()).done;)for(var p,f=s.value,h=U(c);!(p=h()).done;){var g=p.value;if(f==g.value){l.push(g.value),d.push($e(g.text));break}}n.val(l.join(ew.MULTIPLE_OPTION_SEPARATOR)),n.parent().find(".ew-lookup-text").html(Be(d,n.data("maxcount")))}}else t.type&&(t.value=a.join(ew.MULTIPLE_OPTION_SEPARATOR));if(function(t){if(!e(t).data("autoselect"))return!1;var a=ce(t);if(a){if(/s(ea)?rch$/.test(a.id))return!1;var n=K.get(a.id).getList(t.id);return!n||0!=n.parentFields.length}return!1}(t)&&t.options&&(t.list||"select-one"!=t.type||2!=t.options.length||t.options[1].selected?1!=t.options.length||t.options[0].selected||(t.options[0].selected=!0):t.options[1].selected=!0,t.list&&t.render(),ve(t))){var m=t.options||[];1==m.length&&(t.value=m[0].value,t.input.value=m[0].text)}}}function Ve(){e("form.ew-form.ew-wait").removeClass("ew-wait").each((function(){var e=K.get(this.id);e&&(e.multiPage&&e.multiPage.lastPageSubmit||e.enableForm())})),ew.removeSpinner(),G.data("_ajax",!1)}function Ke(e,t){var a=e.replace(/<head>[\s\S]*<\/head>/,"").matchAll(/<script([^>]*)>([\s\S]*?)<\/script\s*>/gi);Array.from(a).forEach((function(e,a){var n=e[2];/(\s+type\s*=\s*['"]*text\/javascript['"]*)|^((?!\s+type\s*=).)*$/i.test(e[1])&&n&&ze(n,"scr_"+t+"_"+a++)}))}function Ge(e){for(var t,a=U(e.matchAll(/<script([^>]*)>([\s\S]*?)<\/script\s*>/gi));!(t=a()).done;){var n=t.value,r=n[0];/(\s+type\s*=\s*['"]*text\/javascript['"]*)|^((?!\s+type\s*=).)*$/i.test(n[1])&&(e=e.replace(r,""))}return e}function ze(e,t){var a=document.createElement("SCRIPT");return t&&(a.id=t),a.text=e,document.body.appendChild(a)}function We(t){t&&e("script[id^='scr_"+t+"_']").remove()}function qe(t){var a=Ge(t).match(/<body[\s\S]*>[\s\S]*<\/body>/i);return a?e(a[0]).not("div[id^=ew].modal, #ew-tooltip, #ew-drilldown-panel, #cookie-consent, #template-upload, #template-download"):e()}function Je(e){return e.options?Array.prototype.map.call(e.options,(function(e){return[e.value,e.text]})):[]}function Xe(t){var a=e(this),n=a.data("args");We("ModalDialog");var r=a.removeData("args").find(".modal-body form").data("form");r&&r.destroyEditor();var i=a.find(".modal-body").html("");i.ewjtable&&i.ewjtable("instance")&&i.ewjtable("destroy"),a.find(".modal-footer .btn-primary").unbind(),a.find(".modal-dialog").removeClass((function(e,t){var a=t.match(/table\-\w+/);return a?a[0]:""})),a.data("showing",!1),a.data("url",null),n&&n.reload&&window.location.reload(!0)}function Qe(t){var a=K.get(t).$element[0];if(a){var n=Le(t),r=Me(t),i=r.match(/^([xy])(\d*)_/),o=i?i[2]:"",s=K.get(t).getList(r),l=s.autoFillTargetFields,d=function(n){for(var i=n&&n.records||"",s=i?i[0]:[],d=0;d<l.length;d++){var c=Ce(l[d].replace(/^x_/,"x"+o+"_"),a);if(c){var u=e.isValue(s["af"+d])?String(s["af"+d]):"",p={results:i,result:s,data:u,form:a,name:r,target:l[d],cancel:!1,trigger:!0};if(e(t).trigger("autofill",[p]),p.cancel)continue;u=p.data,c.options?(He(c,u.split(",")),ve(c)?(c.input.value=u,ue.call(K.get(a.id),c)):we(c)&&ue.call(K.get(a.id),c)):me(c)?(c.value=u,e(c).data("editor").set()):c.value=u,p.trigger&&e(c).trigger("change")}}return s};if(n.length>0&&""!=n[0]){var c=Object.assign({page:s.page,field:s.field,ajax:"autofill",v0:n[0],language:ew.LANGUAGE_ID},fe("#p_"+r,a)),u=s.parentFields.slice();if(""!=o)for(var p=0,f=u.length;p<f;p++){1==(n=u[p].split(" ")).length&&(u[p]=u[p].replace(/^x_/,"x"+o+"_"))}for(var h=u.map((function(e){return Le(e,a)})),g=(p=0,h.length);p<g;p++)c["v"+(p+1)]=h[p].join(ew.MULTIPLE_OPTION_SEPARATOR);return e.post(X(ew.API_LOOKUP_ACTION),c,d,"json")}return d()}}function Ze(t,a){var n=e(a),r=e("#"+n.data("tooltip-id")),i=n.data("trigger")||"hover",o=n.data("placement")||(ew.CSS_FLIP?"left":"right");r[0]&&(""!=r.text().trim()||r.find("img[src!='']")[0])&&(n.data("bs.popover")||n.popover({html:!0,placement:o,trigger:i,delay:100,container:e("#ew-tooltip")[0],content:r.html(),sanitizeFn:ew.sanitizeFn}).on("show.bs.popover",(function(t){var a,r=e(n.data("bs.popover").getTipElement()).css("z-index",9999);(a=n.data("tooltip-width"))&&r.css("max-width",parseInt(a,10)+"px")})))}function et(){return location.href.split("#")[0].split("?")[0]}function tt(e){return st(e,"us",ew.DATE_SEPARATOR)}function at(e){return st(e,"usshort",ew.DATE_SEPARATOR)}function nt(e){return st(e,"std",ew.DATE_SEPARATOR)}function rt(e){return st(e,"stdshort",ew.DATE_SEPARATOR)}function it(e){return st(e,"euro",ew.DATE_SEPARATOR)}function ot(e){return st(e,"euroshort",ew.DATE_SEPARATOR)}function st(e,t,a){if(!e||""==e.length)return!0;var n=(e=e.replace(/ +/g," ").trim()).split(" ");if(n.length>0){var r,i,o,s,l;if(i=(r=/^(\d{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2]\d|[3][0|1])$/).exec(n[0]))o=i[1],s=i[2],l=i[3];else{var d=pt(a);switch(t){case"std":r=new RegExp("^(\\d{4})"+d+"([0]?[1-9]|[1][0-2])"+d+"([0]?[1-9]|[1|2]\\d|[3][0|1])$");break;case"stdshort":r=new RegExp("^(\\d{2})"+d+"([0]?[1-9]|[1][0-2])"+d+"([0]?[1-9]|[1|2]\\d|[3][0|1])$");break;case"us":r=new RegExp("^([0]?[1-9]|[1][0-2])"+d+"([0]?[1-9]|[1|2]\\d|[3][0|1])"+d+"(\\d{4})$");break;case"usshort":r=new RegExp("^([0]?[1-9]|[1][0-2])"+d+"([0]?[1-9]|[1|2]\\d|[3][0|1])"+d+"(\\d{2})$");break;case"euro":r=new RegExp("^([0]?[1-9]|[1|2]\\d|[3][0|1])"+d+"([0]?[1-9]|[1][0-2])"+d+"(\\d{4})$");break;case"euroshort":r=new RegExp("^([0]?[1-9]|[1|2]\\d|[3][0|1])"+d+"([0]?[1-9]|[1][0-2])"+d+"(\\d{2})$")}if(!r.test(n[0]))return!1;var c=n[0].split(a);switch(t){case"std":case"stdshort":o=lt(c[0]),s=c[1],l=c[2];break;case"us":case"usshort":o=lt(c[2]),s=c[0],l=c[1];break;case"euro":case"euroshort":o=lt(c[2]),s=c[1],l=c[0]}}if(!dt(o,s,l))return!1}return!(n.length>1&&!ht(n[1]))}function lt(e){return 2==e.length?e>ew.UNFORMAT_YEAR?"19"+e:"20"+e:e}function dt(e,t,a){e=parseInt(e,10),t=parseInt(t,10),a=parseInt(a,10);var n=[4,6,9,11].includes(t)?30:31;return 2==t&&(n=e%4>0||e%100==0&&e%400>0?28:29),ft(a,1,n)}function ct(e){if(!(e=String(e))||0==e.length)return!0;e=e.trim();var t=pt(ew.THOUSANDS_SEP),a=pt(ew.DECIMAL_POINT);return new RegExp("^[+-]?(\\d{1,3}("+(t?t+"?":"")+"\\d{3})*("+a+"\\d+)?|"+a+"\\d+)$").test(e)}function ut(e){if(e=String(e),""!=ew.THOUSANDS_SEP){var t=new RegExp(pt(ew.THOUSANDS_SEP),"g");e=e.replace(t,"")}return""!=ew.DECIMAL_POINT&&(e=e.replace(ew.DECIMAL_POINT,".")),parseFloat(e)}function pt(e){return e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&")}function ft(t,a,n){return!t||0==t.length||((e.isNumber(a)||e.isNumber(n))&&ct(t)&&(t=ut(t)),!(!e.isNull(a)&&t<a)&&!(!e.isNull(n)&&t>n))}function ht(e){return!e||0==e.length||(e=e.trim(),new RegExp("^(0\\d|1\\d|2[0-3])"+pt(ew.TIME_SEPARATOR)+"[0-5]\\d(( ("+pt(ew.language.phrase("AM"))+"|"+pt(ew.language.phrase("PM"))+"))|("+pt(ew.TIME_SEPARATOR)+"[0-5]\\d(\\.\\d+|[+-][\\d:]+)?)?)$","i").test(e))}function gt(e){return!e||0==e.length||/^[\w.%+-]+@[\w.-]+\.[A-Z]{2,18}$/i.test(e.trim())}function mt(t){var a,n=window.parent,r=null!==(a=null==t?void 0:t.target)&&void 0!==a?a:n.document,i=n.Swal,o=e(r).find("div.ew-message-dialog:hidden").first(),s=o.length?o.text():"";if(e.isString(t)&&(s=e("<div>"+t.trim()+"</div>").text()),""!=s.trim())return o.length&&["success","info","warning","danger"].forEach((function(e,t){var a=o.find(".alert-"+e).toggleClass("alert-"+e),n=a.find(".alert-heading").detach(),r=a.children(":not(.icon)");if(a.find(".icon").remove(),a[0]){var i=parseInt(r.css("width"),10);i>0&&r.first().css("width","auto");var s=le({class:"ew-toast bg-"+e,title:n[0]?n.html():ew.language.phrase(e),body:a.html(),autohide:"success"==e&&ew.autoHideSuccessMessage,delay:"success"==e?ew.autoHideSuccessMessageDelay:500});i>0&&s.css("max-width",i)}else;})),e.isString(t)?i.fire(Y(Y({},ew.sweetAlertSettings),{},{html:t})):void 0}function wt(){return Math.floor(100001*Math.random())+1e5}function vt(t,a,n){var r=new URL(t),i=r.searchParams;if(i.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),i.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN),Ne(n,"post")){var o=a?e(a):e("<form></form>").appendTo("body");o.attr({action:ar[0],method:"post"}),i.forEach((function(t,a){e('<input type="hidden">').attr({name:a,value:ew.sanitize(t)}).appendTo(o)})),o.trigger("submit")}else window.location=Q(r.toString())}G.ajaxSend((function(e,t,a){var n=a.url;n.match(/\/(\w+preview|session)\?/i)&&W();var r=X(),i=n.startsWith(r),o=i||n.startsWith(et());!o&&n.match(/^http/i)&&(o=new URL(n).hostname==V.hostname);if(o)if(i&&ew.API_JWT_TOKEN&&!ew.IS_WINDOWS_AUTHENTICATION&&t.setRequestHeader(ew.API_JWT_AUTHORIZATION_HEADER,"Bearer "+ew.API_JWT_TOKEN),"GET"==a.type){var s=a.url.split("?");(l=new URLSearchParams(s[1])).set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),l.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN),s[1]=l.toString(),a.url=s[0]+(s[1]?"?"+s[1]:"")}else{var l;if(a.data instanceof FormData)a.data.set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),a.data.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN);else(l=new URLSearchParams(a.data)).set(ew.TOKEN_NAME_KEY,ew.TOKEN_NAME),l.set(ew.ANTIFORGERY_TOKEN_KEY,ew.ANTIFORGERY_TOKEN),a.data=l.toString()}})),G.ajaxStart((function(){G.data("_ajax",!0),ew.addSpinner(),e("form.ew-form").addClass("ew-wait").each((function(){var e=K.get(this.id);e&&(e.multiPage&&e.multiPage.lastPageSubmit||e.disableForm())}))})),G.ajaxStop(Ve).ajaxError(Ve);var bt=Object.freeze({__proto__:null,currentUrl:V,forms:K,AjaxLookup:D,AutoSuggest:M,Form:L,SelectionListOption:j,removeSpinner:function(){var t=z.data("_spinner");t&&t.cancel(),t=e.later(500,null,(function(){!0!==G.data("_ajax")&&(W(),e("form.ew-form").each((function(){var e=K.get(this.id);if(e)return e.focus(),!1})))})),z.data("_spinner",t)},createSelect:function(t){var a;t.selectId.includes("$rowindex$")||e.fn.select2.amd.require(["select2/utils","select2/results","select2/dropdown/infiniteScroll","select2/dropdown/hidePlaceholder","select2/dropdown/selectOnClose"],(a=t,function(t,n,r,i,o){var s=Object.assign({},ew.selectOptions,a);if(null==s.resultsAdapter&&(s.resultsAdapter=n,s.dropdown&&s.columns&&s.customOption&&(s.resultsAdapter=t.Decorate(s.resultsAdapter,function(t){return function(){function a(){}var n=a.prototype;return n.render=function(t){var a=e('<div class="select2-results__options '+this.options.get("containerClass")+'" role="listbox"></div>');return this.options.get("multiple")&&a.attr("aria-multiselectable","true"),this.$results=a,a},n.displayMessage=function(t,a){var n=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var r=e('<div role="alert" aria-live="assertive" class="select2-results__option"></div>');if(a.message.includes("<")&&a.message.includes(">"))r.append(a.message);else{var i=this.options.get("translations").get(a.message);r.append(n(i(a.args)))}r[0].className+=" select2-results__message",this.$results.append(r)},n.append=function(t,a){var n=this;if(this.hideLoading(),null!=a.results&&0!==a.results.length){a.results=this.sort(a.results);for(var r=this.options.get("columns"),i=a.results.length,o=this.$results.find("."+this.options.get("rowClass")).last(),s=0;s<a.results.length;s++){var l=a.results[s],d=this.option(l);if(o.length&&o.children().length!=r||(o=e('<div class="'+this.options.get("rowClass")+'"></div>'),this.$results.append(o)),o.append(d),s==i-1)for(var c=r-o.children().length,u=0;u<c;u++)o.append('<div class="'+this.options.get("colClass")+'"></div>')}}else 0===this.$results.children().length&&(this.$element.data("updating")?(this.trigger("results:message",{message:'<div class="spinner-border spinner-border-sm text-primary ew-select-spinner" role="status"><span class="sr-only">'+ew.language.phrase("Loading")+"</span></div> "+ew.language.phrase("Loading")}),this.$element.one("updatedone",(function(){return n.$element.select2("close").select2("open")}))):this.trigger("results:message",{message:"noResults"}))},n.option=function(e,a){var n=document.createElement("div");n.className="select2-results__option "+this.options.get("cellClass");var r={role:"option","aria-selected":"false"},i=window.Element.prototype.matches||window.Element.prototype.msMatchesSelector||window.Element.prototype.webkitMatchesSelector;for(var o in(null!=a.element&&i.call(a.element,":disabled")||null==a.element&&a.disabled)&&(delete r["aria-selected"],r["aria-disabled"]="true"),null==a.id&&delete r["aria-selected"],null!=a._resultId&&(n.id=a._resultId),a.title&&(n.title=a.title),r){var s=r[o];n.setAttribute(o,s)}return this.template(a,n),t.StoreData(n,"data",a),n},a}()}(t)),s.iconClass&&s.multiple&&!s.templateResult&&(s.templateResult=function(e){return'<label class="'+s.iconClass+' ew-dropdown-label">'+e.text+"</label>"})),null!=s.ajax&&(s.resultsAdapter=t.Decorate(s.resultsAdapter,r)),null!=s.placeholder&&(s.resultsAdapter=t.Decorate(s.resultsAdapter,i)),s.selectOnClose&&(s.resultsAdapter=t.Decorate(s.resultsAdapter,o))),e.isObject(s.ajax)){var l=new ew.AjaxLookup(s.ajax);s.ajax={url:function(e){var t=e.page?(e.page-1)*(settings.limit||ew.AUTO_SUGGEST_MAX_ENTRIES):-1;return l.getUrl(e.term,t)},type:"POST",dataType:"json",data:l.generateRequest(),delay:s.debounce,processResults:function(e){return{results:l.transform(e).map((function(e){return{id:e[0],text:l.formatResult({lf:e[0],df:e[1],df2:e[2],df3:e[3],df4:e[4]})}})),pagination:{more:e.length<l.recordCount}}}}}e("select[data-select2-id='"+s.selectId+"']").select2(s),s.multiple&&s.minimumResultsForSearch===1/0&&e("select[id='<#= ctl #>']").on("select2:opening select2:closing",(function(t){e(this).parent().find(".select2-search__field").prop("disabled",!0)}))}))},initIcons:q,initPasswordOptions:J,getApiUrl:X,sanitizeUrl:Q,setSessionTimer:function(){var t,a,n,r,i=ew.SESSION_KEEP_ALIVE_INTERVAL>0||ew.IS_LOGGEDIN&&ew.IS_AUTOLOGIN,o=function(){e.get(X(ew.API_SESSION_ACTION),{rnd:wt()},(function(t){t&&e.isObject(t)&&(ew.TOKEN_NAME=t[ew.TOKEN_NAME_KEY],ew.ANTIFORGERY_TOKEN=t[ew.ANTIFORGERY_TOKEN_KEY])}))},s=function(){r=ew.SESSION_TIMEOUT_COUNTDOWN,(t=ew.SESSION_TIMEOUT-ew.SESSION_TIMEOUT_COUNTDOWN)<0&&(t=0,r=ew.SESSION_TIMEOUT),a&&a.cancel()},l=function(){if(n&&n.cancel(),r>0){var e,t='<p class="text-danger">'+ew.language.phrase("SessionWillExpire")+"</p>";t.includes("%m")&&t.includes("%s")?t=(t=t.replace("%m",'<span class="ew-session-counter-minute">'+Math.floor(r/60)+"</span>")).replace("%s",'<span class="ew-session-counter-second">'+r%60+"</span>"):t.includes("%s")&&(t=t.replace("%s",'<span class="ew-session-counter-second">'+r+"</span>")),Swal.fire(Y(Y({},ew.sweetAlertSettings),{},{html:t,showConfirmButton:!0,confirmButtonText:ew.language.phrase("OKBtn"),timer:1e3*r,timerProgressBar:!0,allowOutsideClick:!1,allowEscapeKey:!1,onBeforeOpen:function(){e=setInterval((function(){var e=Swal.getContent(),t=e.querySelector(".ew-session-counter-minute"),a=e.querySelector(".ew-session-counter-second"),n=Math.round(Swal.getTimerLeft()/1e3);t&&a?(t.textContent=Math.floor(n/60),a.textContent=n%60):a&&(a.textContent=n)}),1e3)},onClose:function(){clearInterval(e)}})).then((function(e){e.value?(o(),!i&&ew.SESSION_TIMEOUT>0&&d()):e.dismiss===Swal.DismissReason.timer&&(s(),window.location=Q(ew.TIMEOUT_URL+"?expired=1"))}))}},d=function(){s(),a=e.later(1e3*t,null,l)};if(i){var c=ew.SESSION_KEEP_ALIVE_INTERVAL>0?ew.SESSION_KEEP_ALIVE_INTERVAL:ew.SESSION_TIMEOUT-ew.SESSION_TIMEOUT_COUNTDOWN;c<=0&&(c=60),n=e.later(1e3*c,null,o,null,!0)}else ew.SESSION_TIMEOUT>0&&d()},initExportLinks:Z,initMultiSelectCheckboxes:ee,fileDownload:te,lazyLoad:ae,updateDropdownPosition:function(){var t=e(".select2-container--open").prev(".ew-select").data("select2");t&&(t.dropdown._positionDropdown(),t.dropdown._resizeDropdown())},initLightboxes:ne,initPdfObjects:re,initTooltips:ie,parseJson:oe,searchOperatorChanged:function(t){var a=e(t).closest("[id^=r_], [id^=xsc_]"),n=t.id.substr(2),r=a.find(".ew-search-field"),i=a.find(".ew-search-field2"),o=i.find("[name='y_"+n+"'], [name='y_"+n+"[]']").length,s=a.find(".ew-search-cond"),l=s.length,d=a.find(".ew-search-and"),c=a.find(".ew-search-operator").find("[name='z_"+n+"']").val(),u=a.find(".ew-search-operator2"),p=u.find("[name='w_"+n+"']").val(),f="BETWEEN"==c,h=["IS NULL","IS NOT NULL"].includes(c),g=["IS NULL","IS NOT NULL"].includes(p),m=!o||f,w=h,v=!f&&(!l||g);s.toggleClass("d-none",m).find(":input").prop("disabled",m),d.toggleClass("d-none",!f),u.toggleClass("d-none",m).find(":input").prop("disabled",m),r.toggleClass("d-none",w).find(":input").prop("disabled",w),i.toggleClass("d-none",v).find(":input").prop("disabled",v)},prompt:se,toast:le,showToast:de,getForm:ce,hasFormData:function(t){for(var a=e(t).find("[name^=x_],[name^=y_],[name^=z_],[name^=w_],[name=psearch]").filter(":enabled").get(),n=0,r=a.length;n<r;n++){var i=a[n];if(/^(z|w)_/.test(i.name)){if(/^IS/.test(e(i).val()))return!0}else if("checkbox"==i.type||"radio"==i.type){if(i.checked)return!0}else if("select-one"==i.type||"select-multiple"==i.type){if(e(i).val())return!0}else if(("text"==i.type||"hidden"==i.type||"textarea"==i.type)&&i.value)return!0}return!1},setSearchType:function(t,a){var n=e(t),r=n.closest("form"),i="";return r.find("input[name=psearchtype]").val(a||""),i="="==a?ew.language.phrase("QuickSearchExactShort"):"AND"==a?ew.language.phrase("QuickSearchAllShort"):"OR"==a?ew.language.phrase("QuickSearchAnyShort"):ew.language.phrase("QuickSearchAutoShort"),r.find("#searchtype").html(i+(i?"&nbsp;":"")),n.closest("ul").find("li").removeClass("active"),n.closest("li").addClass("active"),!1},updateOptions:ue,getUserParams:fe,applyTemplate:function(t,a,n,r,i){var o={data:i||{},id:t,template:a,class:n,export:r,enabled:!0};if(G.trigger("rendertemplate",[o]),o.enabled)if(document.body.replaceWith){var s=document.getElementById(a).content;if(s.querySelectorAll(".ew-slot").forEach((function(e){var t=document.getElementById(e.name||e.id);t&&t.content?(e.dataset.rowspan>1&&Array.prototype.slice.call(t.content.childNodes).forEach((function(t){return t.rowSpan=e.dataset.rowspan})),e.replaceWith(t.content)):e.remove()})),e.views){var l=s.textContent;if(l.includes("{{")&&l.includes("}}")){var d=Array.prototype.slice.call(s.querySelectorAll("script"));d.forEach((function(e){return e.remove()}));var c=document.createElement("div");c.appendChild(s);var u=c.innerHTML,p=e.templates(u);document.getElementById(t).innerHTML=p.render(o.data,ew.jsRenderHelpers),d.forEach((function(e){return document.body.appendChild(e)}))}else document.getElementById(t).appendChild(s)}else document.getElementById(t).appendChild(s)}else be(ew.language.phrase("UnsupportedBrowser")||"Your browser is not supported by this page.");r&&"print"!=r&&e((function(){var a=e("meta[http-equiv='Content-Type']"),n="<html><head>",i=e("#"+t);i.children(0).is("div[id^=ct_]")&&(i=i.children(0)),a[0]&&(n+="<meta http-equiv='Content-Type' content='"+a.attr("content")+"'>"),n+="pdf"==r?"<link rel='stylesheet' type='text/css' href='"+ew.PDF_STYLESHEET_FILENAME+"'>":"<style>"+e.ajax({async:!1,type:"GET",url:ew.PROJECT_STYLESHEET_FILENAME}).responseText+"</style>",n+="</head><body>",e(".ew-chart-top").each((function(){n+=e(this).html()})),n+=i.html(),e(".ew-chart-bottom").each((function(){n+=e(this).html()})),n+="</body></html>";var s=et(),l={customexport:r,data:n,filename:o.class};if(l[ew.TOKEN_NAME]=ew.ANTIFORGERY_TOKEN,"email"==r){var d=V.searchParams.toString()+"&"+e.param(l);e.post(s,d,(function(e){mt(e)}))}else te(s,l);window.parent.jQuery("body").css("cursor","default")}))},toggleGroup:function(t){for(var a,n=e(t),r=n.closest("tr"),i="tr",o=1;o<=6;o++){var s=1==o?"":"-"+o,l=r.data("group"+s);e.isValue(l)&&(a=o,""!=l&&(i+="[data-group"+s+"='"+String(l).replace(/'/g,"\\'")+"']"))}n.hasClass("icon-collapse")?(e(i).slice(1).addClass("ew-rpt-grp-hide-"+a),n.toggleClass("icon-expand icon-collapse")):(e(i).slice(1).removeClass("ew-rpt-grp-hide-"+a),n.toggleClass("icon-expand icon-collapse"))},convertToBool:he,valueChanged:function(e,t,a,n){var r=Ce("x"+t+"_"+a,e),i=Pe("o"+t+"_"+a,e),o=Pe("fn_x"+t+"_"+a,e);if(!i&&(!r||Array.isArray(r)&&0==r.length))return!1;var s=function(e){return Le(e).join()};if(i&&r)if(n){if(he(s(i))===he(s(r)))return!1}else if(s(i)==s(o||r))return!1;return!0},setLanguage:function(t){var a=e(t),n=a.val()||a.data("language");n&&(V.searchParams.set("language",n),window.location=Q(V.toString()))},submitAction:function(t,a){var n=t.target||t.srcElement,r=e(n),i=a.f||r.closest("form")[0]||currentForm,o=e(i),s=a.key,l=a.action,d=a.url||et(),c=a.msg,u=a.data,p=a.success,f=!a.method||Ne(a.method[0],"p"),h=!a.select&&!a.key||a.select&&Ne(a.select[0],"m");if(h&&!o[0])return!1;if(h&&!Ee(o[0]))return se('<p class="text-danger">'+ew.language.phrase("NoRecordSelected")+"</p>"),!1;var g=function(e){mt(e)},m=function(){if(f){if(l&&e("<input>").attr({type:"hidden",name:"useraction",value:l}).appendTo(o),e.isObject(u))for(var t in u){var a=o.find("input[type=hidden][name='"+t+"']");a[0]?a.val(u[t]):e("<input>").attr({type:"hidden",name:t,value:u[t]}).appendTo(o)}if(!h&&e.isObject(s))for(var t in s)e("<input>").attr({type:"hidden",name:t,value:s[t]}).appendTo(o);o.prop("action",d).submit(),l&&o.find("input[type=hidden][name=useraction]").remove()}else u=e.isObject(u)?e.param(u):e.isString(u)?u:"",l&&(u+="&useraction="+l+"&ajax="+l),h?u+="&"+o.find("input[name='key_m[]']:checked").serialize():s&&(u+="&"+(e.isObject(s)?e.param(s):s)),p&&e.isString(p)&&(p=window[p]),e.isFunction(p)?e.post(d,u,p):e.isObject(p)?(p.data=u,p.method=p.method||"POST",p.success=p.success||g,e.ajax(d,p)):e.post(d,u,g)};return c?se(c,(function(e){e&&m()})):m(),!1},export:ge,removeSpaces:function(e){return/^(<(p|br)\/?>(&nbsp;)?(<\/p>)?)?$/i.test(e.replace(/\s/g,""))?"":e},isHiddenTextArea:me,isModalLookup:we,isAutoSuggest:ve,alert:be,clearError:function(t){if(t.jquery){var a=t.attr("type");t="checkbox"==a||"radio"==a?t.get():t[0]}e(t).closest("[id^=el_], .form-group").find(".invalid-feedback").html("")},onError:function(t,a,n,r){if(a.jquery){var i=a.attr("type");a="checkbox"==i||"radio"==i?a.get():a[0]}else a instanceof C&&(a=a.element);return e(a).closest("[id^=el_], .form-group").find(".invalid-feedback").append("<p>"+n+"</p>"),r&&ye(a),null==t||t.makeVisible(a),!1},setFocus:ye,setInvalid:function(t){if(t){var a=e(t);if(!Re(a)){!t.options&&t.length&&(t=a[0]);var n=a.closest(".form-group, [id^='el']");ve(t)?n.find(".ew-auto-suggest").addClass("is-invalid").one("click keydown",(function(){n.find(".is-invalid").removeClass("is-invalid")})):we(t)?n.find(".input-group").addClass("is-invalid").one("click keydown",(function(){n.find(".is-invalid").removeClass("is-invalid")})):"checkbox"==t.type||"radio"==t.type?a.addClass("is-invalid").one("click keydown",(function(){n.find(".is-invalid").removeClass("is-invalid")})):(a.addClass("is-invalid").parent().one("click keydown",(function(){n.find(".is-invalid").removeClass("is-invalid")})),a.closest(".input-group").addClass("is-invalid"))}}},hasValue:function(e){return""!=Le(e).join("")},isMaskedPassword:function(t){var a=e(t).val();return a&&a.match(/^\*+$/)},sort:function(e,t,a){return e.shiftKey&&!e.ctrlKey?t=t.split("?")[0]+"?cmd=resetsort":2==a&&e.ctrlKey&&(t+="&ctrl=1"),window.location=Q(t),!0},confirmDelete:function(e){return Ae(e),se(ew.language.phrase("DeleteConfirmMsg"),(function(t){t&&e.href?window.location=Q(e.href):Oe(e)})),!1},keySelected:Ee,selectAllKey:function(t){_e(t);var a=e(t).closest(".ew-table")[0];a&&e(a.tBodies).each((function(){e(this.rows).each((function(a,n){var r=e(n);r.is(":not(.ew-template):not(.ew-table-preview-row)")&&(r.data({selected:t.checked,checked:t.checked}),Se(a,n))}))}))},selectAll:_e,updateSelected:function(t){return e(t).find("input[type=checkbox][name^=u_]:checked,input:hidden[name^=u_][value=1]").length>0},setColor:Se,clearSelected:xe,clearDelete:Oe,clickDelete:Ae,clickMultiCheckbox:function(t){var a=t.target||t.srcElement,n=e(a),r=n.closest(".ew-table")[0];if(r){xe(r);var i=n.closest(".ew-table > tbody > tr");i.siblings("[data-rowindex='"+i.data("rowindex")+"']").addBack().each((function(t,n){e(n).data("checked",a.checked).data("selected",a.checked).find("input[type=checkbox][name='key_m[]']").each((function(){this!=a&&(this.checked=a.checked)})),Se(0,n)})),t.stopPropagation()}},setupTable:Te,setupGrid:Ie,addGridRow:function(t){var a=e(t).closest(".ew-grid"),n=a.find("table.ew-table").last(),r=n.parent("div"),i=n.find("tr.ew-template");if(!(t&&a[0]&&n[0]&&i[0]))return!1;var o=e(n[0].rows).last();n.find("td.ew-table-last-row").removeClass("ew-table-last-row");var s=i.clone(!0,!0).removeClass("ew-template"),l=a.find("div.ew-form[id^=f][id$=grid]");l[0]||(l=a.find("form.ew-form[id^=f][id$=list]"));var d=l.is("div")?"_"+l.attr("id"):"",c=l.find("#key_count"+d),u=parseInt(c.val(),10)+1;s.attr({id:"r"+u+s.attr("id").substring(2),"data-rowindex":u});var p=i.find("script:contains('$rowindex$')");s.children("td").each((function(){e(this).find("*").each((function(){e.each(this.attributes,(function(e,t){t.value=t.value.replace(/\$rowindex\$/g,u)}))}))})),s.find(".ew-icon").closest("a, button").removeData("bs.tooltip").tooltip({container:"body",placement:"bottom",trigger:"hover",sanitizeFn:ew.sanitizeFn}),c.val(u).after(e("<input>").attr({type:"hidden",id:"k"+u+"_action"+d,name:"k"+u+"_action"+d,value:"insert"})),o.after(s),p.each((function(){ze(this.text.replace(/\$rowindex\$/g,u))}));var f=l.data("form");return f&&(f.initEditors(),f.initUpload()),Te(-1,n[0],!0),r.scrollTop(r[0].scrollHeight),!1},deleteGridRow:function(t,a){var n=e(t).tooltip("hide").removeData("bs.tooltip"),r=n.closest(".ew-grid, .ew-multi-column-grid"),i=n.closest("tr, div[data-rowindex]"),o=i.closest(".ew-table");if(!t||!r[0]||!i[0])return!1;var s=parseInt(i.data("rowindex"),10),l=r.find("div.ew-form[id^=f][id$=grid]");l[0]||(l=r.find("form.ew-form[id^=f][id$=list]"));var d=l.data("form");if(!l[0]||!d)return!1;var c=l.is("div")?"_"+l.attr("id"):"",u="#key_count"+c,p=function(){if(i.remove(),r.is(".ew-grid")&&Te(-1,o[0],!0),s>0){var t=l.find("#k"+s+"_action"+c);t[0]?t.val("insert"==t.val()?"insertdelete":"delete"):l.find(u).after(e("<input>").attr({type:"hidden",id:"k"+s+"_action"+c,name:"k"+s+"_action"+c,value:"delete"}))}};return e.isFunction(d.emptyRow)&&d.emptyRow(a)?p():se(ew.language.phrase("DeleteConfirmMsg"),(function(e){e&&p()})),!1},htmlEncode:function(e){return String(e).replace(/&/g,"&amp;").replace(/\"/g,"&quot;").replace(/</g,"&lt;").replace(/>/g,"&gt;")},getElements:Ce,getElement:Pe,getAncestorBy:ke,isHidden:Re,sameText:Ne,sameString:function(e,t){return String(e)==String(t)},getValue:function(t,a){if(!t)return"";var n;if((n=e.isString(t)?2==t.split(" ").length?Ce(t):Ce(t,a):"radio"==t.type||"checkbox"==t.type?Ce(t):t).options){if(n.list){var r=n.values;return n.multiple?r:r[0]||""}var i=Array.prototype.filter.call(n.options,(function(e){return e.selected&&""!==e.value})).map((function(e){return e.value}));return"select-multiple"==n.type?i:i[0]||""}if(e.isNumber(n.length)){var o=e(n).filter(":checked").map((function(){return this.value})).get();return 1==n.length?o[0]:o}if(ew.isHiddenTextArea(n))return e(n).data("editor").save(),n.value;var s=e(n).data();return s.lookup&&s.multiple?n.value.split(ew.MULTIPLE_OPTION_SEPARATOR):n.value},getOptionValues:Le,getOptionTexts:De,clearOptions:je,getId:Me,valueSeparator:Fe,displayValue:Ue,optionHtml:$e,optionsHtml:Be,newOption:Ye,selectOption:He,executeScript:Ke,stripScript:Ge,addScript:ze,removeScript:We,getContent:qe,getOptions:Je,addOptionDialogShow:function(t){var a=ew.addOptionDialog||e("#ew-add-opt-dialog").on("hidden.bs.modal",(function(){We(a.data("args").el);var e=a.removeData("args").find(".modal-body form").data("form");e&&e.destroyEditor(),a.find(".modal-body").html(""),a.find(".modal-footer .btn-primary").unbind(),a.data("showing",!1)}));if(a[0]){if(!a.data("showing")){a.data("showing",!0);var n=function(t){var n,r=t,i=a.data("args"),o=K.get(i.lnk),s=a.find(".modal-body form input[name='"+ew.API_OBJECT_NAME+"']").val(),l=i.el,d=/^x(\d+)_/,c=l.match(d),u=c?c[0]:"x_",p=c?c[1]:-1,f=l.replace(d,"x_"),h=o.getList(l);if(e.isString(t)&&(r=oe(t)),(null===(n=r)||void 0===n?void 0:n.success)&&r[s]){a.modal("hide");var g=r[s],m=o.$element[0],w=Ce(l,m);if(w){var v=h.linkField,b=h.displayFields.slice(),y=h.filterFields.slice(),E=h.parentFields.slice();E.forEach((function(e,t){1==e.split(" ").length&&(E[t]=E[t].replace(/^x_/,u))}));var _=""!=v?g[v]:"",S={lf:_};if(b.forEach((function(e,t){e in g&&(S["df"+(t||"")]=g[e])})),y.forEach((function(e,t){e in g&&(S["ff"+(t||"")]=g[e])})),_&&b.length>0&&S.df){null===h.ajax&&h.lookupOptions.push(S);var x=E.map((function(e){return Le(e,m)}));i={data:S,parents:x,valid:!0,name:Me(w),form:m};if(G.trigger("addoption",[i]),i.valid){var O=Je(w),A=[],T=Ye(w,S,m);if(w.options)if(w.options[w.options.length-1].selected=!0,w.list&&(w.render(),e(w.target).find("input").last().trigger("focus")),ve(w))e(w).val(_).trigger("change"),e(w.input).val(T).trigger("focus");else if(we(w)){var I=e(w),C=e(Pe("lu_"+i.name,m));if(w.multiple){var P=e(w).val(),k=(A=[],String(_));if(""!==P&&(A=P.split(ew.MULTIPLE_OPTION_SEPARATOR)),!A.includes(k)){A.push(k),I.val(A.join()).trigger("change");var R=C.html(),N=C.find(".ew-option").map((function(){return e(this).html()})).get();N.length?(N.push(T),C.html(Be(N,I.data("maxcount")))):R==ew.language.phrase("PleaseSelect")?C.html($e(T)):R&&C.html(ew.language.phrase("CountSelected").replace("%s",A.length))}}else I.val(_).trigger("change"),C.html(T)}else e(w).trigger("change").trigger("focus");var L=e(m),D=L.is("div")?"_"+L.attr("id"):"",j=L.find("#key_count"+D).val();if(j>0)for(var M=1;M<=j;M++)if(M!=p){var F=Ce(f.replace(/^x/,"x"+M),m),U=Je(F);A=[];JSON.stringify(O)==JSON.stringify(U)&&(Ye(F,S,m),F.options&&w.list&&F.render())}}}}}else{var $;if(null===($=r)||void 0===$?void 0:$.error){var B;e.isString(r.error)?de(r.error):e.isString(null===(B=r.error)||void 0===B?void 0:B.description)&&de(r.error.description)}else{var Y,H,V=e("<div></div>").html(t).find("div.ew-message-dialog");if(V[0])Y=V.html();else(Y=(null===(H=r)||void 0===H?void 0:H.failureMessage)||t)&&""!=String(Y).trim()||(Y=ew.language.phrase("InsertFailed"));de(Y)}}},r=function(e){a.modal("hide"),be("Server Error "+e.status+": "+e.statusText)},i=function(t){var a=ew.addOptionDialog.find(".modal-body form")[0],i=K.get(a.id),o=t?t.target:null,s=e(o);return i.canSubmit()&&(s.prop("disabled",!1).removeClass("disabled"),z.css("cursor","wait"),e.post(X(ew.API_ADD_ACTION),e(a).serialize(),n).fail(r).always((function(){i.enableForm(),s.prop("disabled",!1).removeClass("disabled"),z.css("cursor","default")}))),!1};a.modal("hide"),a.data("args",t);e.get(t.url,(function(n){var r=K.get(t.lnk),o="x_",s=t.el.match(/^(x\d+_)/);s&&(o=s[1]);var l=r.getList(t.el),d=l.parentFields.slice().map((function(e){return 1==e.split(" ").length?e.replace(/^x_/,o):e})),c=r.htmlForm,u=d.map((function(e){return Le(e,c)})),p=d.map((function(e){return De(e,c)})),f=l.filterFieldVars.slice();a.find(".modal-title").html(e(t.lnk).closest(".ew-add-opt-btn").data("title")),a.find(".modal-body").html(Ge(n)),(c=a.find(".modal-body form")[0])&&(e(c).on("keydown",(function(e){if("Enter"==e.key&&"TEXTAREA"!=e.target.nodeName)return i()})),u.forEach((function(t,a){var n;(n=Ce(f[a],c))&&(n.options||n.length?e(n).first().one("updatedone",(function(){return He(n,t)})):He(n,t))}))),ew.addOptionDialog=a.modal("show"),a.find(".modal-footer .btn-primary").click(i).focus(),Ke(n,t.el),c&&u.forEach((function(e,t){var a=Ce(f[t],c);a&&(ve(a)?(a.value=e[0],a.input.value=p[t][0],a.add(e[0],p[t][0],!0)):we(a)?(a.value=e[0],ue.call(K.get(c.id),a)):a.options||a.length||(a.value=e[0]))})),a.trigger("load.ew")})).fail(r)}}else be("DIV #ew-add-opt-dialog not found.")},modalDialogHide:Xe,modalDialogShow:function(t){e(t.lnk).tooltip("hide");var a=t.f;if(a&&!Ee(a))return se('<p class="text-danger">'+ew.language.phrase("NoRecordSelected")+"</p>"),!1;var n=ew.modalDialog||e("#ew-modal-dialog").on("hidden.bs.modal",Xe);if(n.data("showing")&&n.data("url")==t.url)return!1;n.data({showing:!0,url:t.url}),t.reload=!1,"modal-sm"===t.size?n.find(".modal-dialog").toggleClass("modal-sm",!0).toggleClass("modal-lg modal-xl",!1):""===t.size?n.find(".modal-dialog").toggleClass("modal-sm modal-lg modal-xl",!1):"modal-lg"===t.size?n.find(".modal-dialog").toggleClass("modal-lg",!0).toggleClass("modal-sm modal-xl",!1):n.find(".modal-dialog").toggleClass("modal-xl",!0).toggleClass("modal-sm modal-lg",!1);var r=function(){var t=n.data("args"),a=e(t.lnk);return t.caption||a.data("caption")||a.data("original-title")||""},i=function(){var t=n.data("args");return e.isNull(t.btn)?"":t.btn&&""!=t.btn?ew.language.phrase(t.btn):r()},o=function(e){n.modal("hide"),e.status&&be("Server Error "+e.status+": "+e.statusText)},s=function(e){z.css("cursor","default")},l=function(t){var a=oe(t);if(e.isObject(a))if(e.isString(a.failureMessage))be(a.failureMessage);else if(a.error){var r;e.isString(a.error)?be(a.error):e.isString(null===(r=a.error)||void 0===r?void 0:r.description)&&be(a.error.description)}else{var l=a.url;if(a.modal&&!function(t){var a=e("<a>",{href:t})[0];return window.location.pathname.endsWith(a.pathname)}(l)){var u=n.data("args");u.reload=!0,a.caption&&(u.caption=a.caption),u.btn=a.view?null:"",n.data("args",u),l+=(l.split("?").length>1?"&":"?")+"modal=1&rnd="+wt(),z.css("cursor","wait"),e.ajax(l).done(c).fail(o).always(s)}else n.modal("hide"),window.location=Q(l)}else{var p=qe(t);if(p.length){var f=n.find(".modal-body").html(p),h="",g=f.find("#confirm"),m=f.find("#conflict");if(m&&"1"==m.val())h+='<button type="button" id="btn-overwrite" class="btn btn-primary ew-btn">'+ew.language.phrase("OverwriteBtn")+"</button>",h+='<button type="button" id="btn-reload" class="btn btn-default ew-btn">'+ew.language.phrase("ReloadBtn")+"</button>",h+='<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+ew.language.phrase("CancelBtn")+"</button>",n.find(".modal-footer").html(h),n.find(".modal-footer #btn-overwrite").on("click",{action:"overwrite"},d),n.find(".modal-footer #btn-reload").on("click",{action:"show"},d);else if(g&&"confirm"==g.val())h+='<button type="button" class="btn btn-primary ew-btn">'+ew.language.phrase("ConfirmBtn")+"</button>",h+='<button type="button" class="btn btn-default ew-btn">'+ew.language.phrase("CancelBtn")+"</button>",n.find(".modal-footer").html(h),n.find(".modal-footer .btn-primary").click(d).focus(),n.find(".modal-footer .btn-default").on("click",{action:"cancel"},d);else{var w=i();w&&(h+='<button type="button" class="btn btn-primary ew-btn">'+w+"</button>"),h+='<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+ew.language.phrase("CancelBtn")+"</button>",n.find(".modal-footer").html(h),n.find(".modal-footer .btn-primary").addClass("ew-submit").click(d).focus()}Ke(t,"ModalDialog"),n.trigger("load.ew")}else t&&(n.modal("hide"),ew.alert(t))}},d=function(t){var a=n.find(".modal-body form")[0],r=e(a),i=K.get(a.id),d=t&&t.data?t.data.action:null,u=t?t.target:null;if(u){if(u.classList.contains("disabled"))return!1;i.enableForm=function(){e(u).prop("disabled",!1).removeClass("disabled")},i.disableForm=function(){e(u).prop("disabled",!0).addClass("disabled")}}var p=a.elements.action;return d&&p&&(p.value=d),"cancel"==d?e.post(r.attr("action"),r.serialize(),c).fail(o).always(s):i.canSubmit()&&(z.css("cursor","wait"),e.post(r.attr("action"),r.serialize(),l).fail(o).always((function(){i.enableForm(),s()}))),!1};n.modal("hide"),n.data("args",t);var c=function(t){var a=oe(t);if(e.isObject(a))a.error&&be(a.error);else{var o=n.data("args"),s=e(o.lnk);n.find(".modal-title").html(r());var l="",c=i();c&&(l+='<button type="button" class="btn btn-primary ew-btn">'+c+"</button>"),""!=l?l+='<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+ew.language.phrase("CancelBtn")+"</button>":l='<button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+ew.language.phrase("CloseBtn")+"</button>",n.find(".modal-footer").html(l);var u=qe(t);n.find(".modal-body").html(u);var p=s.data("table");p&&n.find(".modal-dialog").addClass("table-"+p);var f=n.find(".modal-footer .btn-primary").addClass("ew-submit").click(d);n.find(".modal-body form").on("keydown",(function(e){if("Enter"==e.key&&"TEXTAREA"!=e.target.nodeName)return f.click()})),ew.modalDialog=n.modal("show"),Ke(t,"ModalDialog"),n.trigger("load.ew"),f.focus()}};z.css("cursor","wait");var u=t.url;if(a){var p=e(a);a.elements.modal||e("<input>").attr({type:"hidden",name:"modal",value:"1"}).appendTo(p),e.post(u,p.serialize(),c).fail(o).always(s)}else u+=(u.split("?").length>1?"&":"?")+"modal=1&rnd="+wt(),e.get(u,c).fail(o).always(s);return!1},modalLookupShow:function(t){var a=t.el,n=ce(t.lnk);if(n&&a){var r=ew.modalLookupDialog||e("#ew-modal-lookup-dialog").on("hidden.bs.modal",Xe);if(r[0]){if(!r.data("showing")){r.data("showing",!0);var i,o,s=e(n).find("[id='"+a+"']"),l=r.find(".modal-body"),d=e(t.lnk),c=d.closest(".ew-lookup-list").find(".ew-lookup-text").trigger("focus"),u=Me(a,!1),p=u.match(/^([xy])(\d*)_/),f=p?p[2]:"",h=K.get(n.id).getList(a),g=function(t){return"OK"==t.result&&Array.isArray(t.records)&&t.records.forEach((function(a,n){var r;Array.isArray(a)?r={lf:a[0],df1:a[1],df2:a[2],df3:a[3],df4:a[4]}:e.isObject(a)&&(r={lf:a.lf,df1:a.df,df2:a.df2,df3:a.df3,df4:a.df4});var i=Ue(a,s);h.template?r.df=h.template.render(r,ew.jsRenderHelpers):r.df=i,r.txt=i,t.records[n]=r})),t},m=function(e,t){if(ve(s)){var a=s[0];a.add(e,t,!0),a.input.value=t}},w=function(){return function(a){var r=[],i=[],o=[],d=[],p=!t.m&&t.srch;if(l.ewjtable("selectedRows").each((function(){var t=e(this).data("record");r.push(t.lf),i.push(t.df),o.push(t.df),d.push(t.txt)})),a.sort().join()===r.sort().join())c.html(Be(o,s.data("maxcount"))),m(r.join(),d.join(", ")),s.val(p?i.join(", "):r.join()).trigger("change");else{var f=Object.assign({page:h.page,field:h.field,ajax:"modal",keys:a},fe("#p_"+u,n));z.css("cursor","wait"),e.ajax(X(ew.API_LOOKUP_ACTION),{type:"POST",dataType:"json",data:f}).done(g).then((function(e){if("OK"==e.result&&Array.isArray(e.records)){for(var t,a=[],n=[],r=[],i=[],o=U(e.records);!(t=o()).done;){var l=t.value;a.push(l.lf),n.push(l.df),r.push(l.df),i.push(l.txt)}c.html(Be(r,s.data("maxcount"))),m(a.join(),i.join(", ")),s.val(p?n.join(", "):a.join()).trigger("change")}})).always((function(){z.css("cursor","default")}))}}(y),r.modal("hide"),!1};r.modal("hide"),r.data("args",t);var v=[],b=s.val(),y=""!==b?b.split(ew.MULTIPLE_OPTION_SEPARATOR):[],E=Object.assign({page:h.page,field:h.field},fe("#p_"+u,n)),_=h.parentFields.slice();if(""!=f)for(var S=0,x=_.length;S<x;S++){1==_[S].split(" ").length&&(_[S]=_[S].replace(/^x_/,"x"+f+"_"))}if(_.length>0)for(S=0,x=_.length;S<x;S++)v.push(Le(_[S],n));S=0;for(var O=v.length;S<O;S++)E["v"+(S+1)]=v[S].join(ew.MULTIPLE_OPTION_SEPARATOR);z.css("cursor","wait"),l.ewjtable({paging:!0,pageSize:t.n,pageSizes:[],pageSizeChangeArea:!1,pageList:"minimal",selecting:!0,selectingCheckboxes:!0,multiselect:!!t.m,actions:{listAction:function(t,a){var n=Object.assign({},E,{ajax:"modal",start:a.start,recperpage:a.recperpage});return e.isObject(t)&&Object.assign(n,t),e.ajax(X(ew.API_LOOKUP_ACTION),{type:"POST",dataType:"json",data:n}).done(g).always((function(){z.css("cursor","default")}))}},messages:{serverCommunicationError:ew.language.phrase("ServerCommunicationError"),loadingMessage:'<div class="'+ew.spinnerClass+' m-3 ew-loading" role="status"><span class="sr-only">'+ew.language.phrase("Loading")+"</span></div>",noDataAvailable:ew.language.phrase("NoRecord"),close:ew.language.phrase("CloseBtn"),pagingInfo:ew.language.phrase("Record")+" {0}-{1} "+ew.language.phrase("Of")+" {2}",pageSizeChangeLabel:ew.language.phrase("RecordsPerPage"),gotoPageLabel:ew.language.phrase("Page")},fields:{lf:{key:!0,list:!1},df:{}},recordsLoaded:function(t,a){var n=e(t.target).find(".ewjtable-data-row").filter((function(){return y.includes(String(e(this).data("record-key")))}));e(t.target).ewjtable("selectRows",n)},selectionChanged:function(a,n){var r=n.rows;r&&(t.m||(y=[]),r.each((function(){var t=e(this),a=String(t.data("record-key")),n=y.indexOf(a),r=t.hasClass("ewjtable-row-selected");r&&-1==n?y.push(a):!r&&n>-1&&y.splice(n,1)})))}}).ewjtable("load",null,(function(a){"OK"==a.result?(r.find(".modal-title").html(d.attr("title")||d.data("original-title")),r.find(".modal-body .ewjtable thead").toggle(!!t.m),r.find(".modal-footer").html('<button type="button" id="btn-select" class="btn btn-primary ew-btn">'+ew.language.phrase("SelectBtn")+'</button><button type="button" class="btn btn-default ew-btn" data-dismiss="modal">'+ew.language.phrase("CancelBtn")+"</button>"),o=r.find(".modal-header .modal-tools input[name=sv]").off("keyup.ew").on("keyup.ew",(function(t){i&&i.cancel(),i=e.later(ew.LOOKUP_DELAY,null,(function(){l.ewjtable("load",{sv:o.val()})}))})),r.find(".modal-footer #btn-select").click(w),ew.modalLookupDialog=r.modal("show"),o.focus()):be(a.message)}))}}else be("DIV #ew-modal-lookup-dialog not found.")}},importDialogShow:function(t){e(t.lnk).tooltip("hide");var a=ew.importDialog||e("#ew-import-dialog");if(!a[0])return be("DIV #ew-import-dialog not found."),!1;var n,r=a.find("#importfiles"),i=a.find(".modal-body"),o=i.find(":input[id!=importfiles]"),s=i.find(".message"),l=i.find(".progress"),d=function(t,n){var r=e("<div>"+t+"</div>");n&&r.addClass(n),s.removeClass("d-none").html(r),"text-danger"==n&&a.find(".modal-footer .btn").prop("disabled",!1)},c=function(){s.addClass("d-none").html("")},u=function(e,t){l.removeClass("d-none").find(".progress-bar").removeClass("bg-success bg-info").addClass(t||"bg-success").attr("aria-valuenow",e).css("width",e+"%").html(e+"%")},p=function(e){try{var t=parseInt(e.count),n=parseInt(e.totalCount),r=e.file;if(n>0&&a.find(".modal-footer .ew-close-btn").data("import-progress")){var i=parseInt(100*t/n);u(i),d(ew.language.phrase("ImportMessageProgress").replace("%t",n).replace("%c",t).replace("%f",r),"text-info")}}catch(e){}},f=function(){var t=X(ew.API_PROGRESS_ACTION),a={rnd:wt()};a[ew.API_FILE_TOKEN_NAME]=r.data(ew.API_FILE_TOKEN_NAME),e.get(t,a,p,"json")},h=function(e){var t="";u(100);var n=e.files;if(a.find(".modal-footer .ew-close-btn").data("import-progress",!1),Array.isArray(n))for(var r=0,i=n.length;r<i;r++){var o=n[r],s=o.totalCount||0,c=o.count||0,p=o.successCount||0,f=o.failCount||0;if(""!=t&&(t+="<br>"),o.success)t+=ew.language.phrase("ImportMessageSuccess").replace("%t",s).replace("%c",c).replace("%f",o.file);else{t+=ew.language.phrase("ImportMessageError1").replace("%t",s).replace("%c",c).replace("%f",o.file).replace("%s",p).replace("%e",f),o.error&&(t+=ew.language.phrase("ImportMessageError2").replace("%e",o.error));var h=!0;if(o.failList){var g=0;for(r=1;r<=c&&(o.failList["row"+r]&&(g+=1,t+="<br>"+ew.language.phrase("ImportMessageError3").replace("%i",r).replace("%d",o.failList["row"+r])),!(g>=5));r++);f>5?t+="<br>"+ew.language.phrase("ImportMessageMore").replace("%s",f-5):h=!1}o.log&&h&&(t+="<br>"+ew.language.phrase("ImportMessageError4").replace("%l",o.log)),d(t,"text-danger")}}e.success?(d(t,"text-success"),a.find(".modal-footer .ew-close-btn").data("imported",!0)):(e.error&&(t=e.error),d(t,"text-danger")),l.addClass("d-none").find(".progress-bar").attr("aria-valuenow",0).css("width","0%").html("0%")},g=function(e){a.find(".modal-footer .ew-close-btn").data("import-progress",!1),d(ew.language.phrase("ImportMessageServerError").replace("%s",e.status).replace("%t",e.statusText),"text-danger")},m={session:ew.SESSION_ID};m[ew.TOKEN_NAME_KEY]=ew.TOKEN_NAME,m[ew.ANTIFORGERY_TOKEN_KEY]=ew.ANTIFORGERY_TOKEN;var w=ew.importUploadOptions;return w.acceptFileTypes||(w.acceptFileTypes=new RegExp("\\.("+ew.IMPORT_FILE_ALLOWED_EXT.replace(/,/g,"|")+")$","i")),r.data("blueimpFileupload")||r.fileupload(Object.assign({url:X(ew.API_UPLOAD_ACTION),dataType:"json",autoUpload:!0,formData:m,singleFileUploads:!1,messages:{acceptFileTypes:ew.language.phrase("UploadErrMsgAcceptFileTypes"),maxFileSize:ew.language.phrase("UploadErrMsgMaxFileSize"),maxNumberOfFiles:ew.language.phrase("UploadErrMsgMaxNumberOfFiles"),minFileSize:ew.language.phrase("UploadErrMsgMinFileSize")},done:function(t,i){if(i.result&&i.result.files&&Array.isArray(i.result.files.importfiles)){var s=!0;i.result.files.importfiles.forEach((function(e,t){e.error&&(d(ew.language.phrase("ImportMessageUploadError").replace("%f",e.name).replace("%s",e.error),"text-danger"),s=!1)})),s&&function(t){z.css("cursor","wait"),r.data(ew.API_FILE_TOKEN_NAME,t),a.find(".modal-footer .ew-close-btn").data("import-progress",!0);var i=ew.API_ACTION_NAME+"=import&"+ew.API_FILE_TOKEN_NAME+"="+encodeURIComponent(t);o.length&&(i+="&"+o.serialize()),e.ajax(et(),{data:i,method:"POST",dataType:"json",beforeSend:function(t,a){n=e.later(100,null,f,null,!0)}}).done(h).fail(g).always((function(){z.css("cursor","default"),n&&n.cancel()}))}(i.result[ew.API_FILE_TOKEN_NAME])}},change:function(e,t){c()},processfail:function(e,t){t.files.forEach((function(e,t){e.error&&d(ew.language.phrase("ImportMessageUploadError").replace("%f",e.name).replace("%s",e.error),"text-danger")}))},fail:function(e,t){d(ew.language.phrase("ImportMessageServerError").replace("%s",t.textStatus).replace("%t",t.errorThrown),"text-danger")},progressall:function(e,t){!function(e){var t=parseInt(100*e.loaded/e.total);u(t,"bg-info"),d(100===t?ew.language.phrase("ImportMessageUploadComplete"):ew.language.phrase("ImportMessageUploadProgress").replace("%p",t),"text-info")}(t)}},w)),a.modal("hide").find(".modal-title").html(t.hdr),a.find(".modal-footer .ew-close-btn").off("click.ew").on("click.ew",(function(){var t=e(this);t.data("imported")&&(t.data("imported",!1),window.location.reload(!0))})),c(),ew.importDialog=a.modal("show"),!1},autoFill:Qe,tooltip:Ze,emailDialogShow:function(t){var a=ew.emailDialog||e("#ew-email-dialog");if(!a[0])return be("DIV #ew-email-dialog not found."),!1;if(t.sel&&!Ee(t.f))return be(ew.language.phrase("NoRecordSelected")),!1;var n=a.find(".modal-body form"),r=n.data("form");return r||((r=new L(n.attr("id"))).addFields([["sender",[ew.Validators.required(ew.language.phrase("Sender")),ew.Validators.email]],["recipient",[ew.Validators.required(ew.language.phrase("Recipient")),ew.Validators.emails(ew.MAX_EMAIL_RECIPIENT,ew.language.phrase("EnterProperRecipientEmail"))]],["cc",ew.Validators.emails(ew.MAX_EMAIL_RECIPIENT,ew.language.phrase("EnterProperCcEmail"))],["bcc",ew.Validators.emails(ew.MAX_EMAIL_RECIPIENT,ew.language.phrase("EnterProperBccEmail"))],["subject",ew.Validators.required(ew.language.phrase("Subject"))]]),r.validate=function(){return this.validateFields()},r.submit=function(){if(!this.validate())return!1;var r=n.serialize(),i="";t.f&&t.sel&&(i=e(t.f).find("input[type=checkbox][name='key_m[]']:checked").serialize()),t.key&&(r+="&"+e.param(t.key));var o=this.getForm();return t.url?(a.modal("hide"),t.exportid?ew.exportWithCharts(t.el,t.url,t.exportid,o):ge(t.f,t.url,"email",!0,t.sel,o)):e.post(e(t.f).attr("action"),r+"&"+i,(function(e){mt(e)})),!0},n.data("form",r)),a.modal("hide").find(".modal-title").html(t.hdr),a.find(".modal-footer .btn-primary").off().click((function(e){e.preventDefault(),r.submit()&&a.modal("hide")})),ew.emailDialog=a.modal("show"),!1},showDrillDown:function(t,a,n,r,i){if(t&&t.ctrlKey){var o=n.split("?"),s=new URLSearchParams(o[1]);return s.set("d","2"),vt(o[0]+"?"+s.toString()),!1}var l=e.isString(a)?e("#"+a):e(a),d=l.data("drilldown-placement")||(l.hasClass("ew-chart-canvas")?ew.CSS_FLIP?"left":"right":"bottom");l.tooltip("hide");var c={obj:l[0],id:r,url:n,hdr:i,placement:d};G.trigger("drilldown",[c]);var u=c.url.split("?");c.file=u[0]||"",c.data=u[1]||"",l.data("bs.popover")||l.popover({html:!0,placement:c.placement,trigger:"manual",template:'<div class="popover"><h3 class="popover-header d-none" style="cursor: move;"></h3><div class="popover-body"></div></div>',content:'<div class="'+ew.spinnerClass+' m-3 ew-loading" role="status"><span class="sr-only">'+ew.language.phrase("Loading")+"</span></div>",container:e("#ew-drilldown-panel"),sanitizeFn:ew.sanitizeFn,boundary:"viewport"}).on("show.bs.popover",(function(e){l.attr("data-original-title","")})).on("shown.bs.popover",(function(t){if(l.data("args")){var a=l.data("args").data;a+=(a?"&":"")+ew.TOKEN_NAME_KEY+"="+ew.TOKEN_NAME,a+=(a?"&":"")+ew.ANTIFORGERY_TOKEN_KEY+"="+ew.ANTIFORGERY_TOKEN,e.ajax({cache:!1,dataType:"html",type:"POST",data:a,url:l.data("args").file,success:function(t){var a=e(l.data("bs.popover").getTipElement()).on("mousedown",(function(t){var a=e(this).addClass("drag"),n=a.outerHeight(),r=a.outerWidth(),i=a.offset().top+n-t.pageY,o=a.offset().left+r-t.pageX;z.on("mousemove",(function(e){var t=e.pageY+i-n,s=e.pageX+o-r;a.hasClass("drag")&&a.offset({top:t,left:s})})).on("mouseup",(function(e){a.removeClass("drag")}))}));c.hdr&&a.find(".popover-header").empty().removeClass("d-none").append('<button type="button" class="close" aria-label="Close"><span aria-hidden="true">&times;</span></button>'+c.hdr).find(".close").on("click",(function(){l.popover("hide")}));var n=t.match(/<body[^>]*>([\s\S]*?)<\/body\s*>/i);t=n?n[0]:t;var i=ew.stripScript(t);a.find(".popover-body").html(e("<div></div>").html(i).find("#ew-report")).find(".ew-table").each(ew.setupTable),ew.executeScript(t,r),l.popover("update")},error:function(t){t.responseText&&e($el.data("bs.popover").getTipElement()).find(".popover-body").empty().append('<p class="text-danger">'+t.responseText+"</p>")}})}})).on("hidden.bs.popover",(function(t){e.each(ew.drillDownCharts,(function(e,t){t.dispose()})),ew.drillDownCharts={},ew.removeScript(r)})),l.data("args",c).popover("show")},ajax:function(t,a){if(e.isObject(t)){var n=t.action;if(n){delete t.action;var r=Object.assign({},t),i=function(t){if(e.isObject(t)&&"OK"==t.result){var a=t.records;return Array.isArray(a)&&1==a.length?(a=a[0],Array.isArray(a)&&1==a.length?a[0]:a):a}return t},o=X(n),s=r.type||"POST";if(delete r.type,r.dataType="json",!e.isFunction(a)){var l=e.ajax({url:o,async:!1,type:s,data:r});return i(l.responseJSON)}e.ajax({url:o,type:s,data:r,success:function(e){a(i(e))}})}}},currentPage:et,toggleSearchOperator:function(e,t){var a=this.form.elements[e];a&&(a.value=a.value!=t?t:"=")},checkUSDate:tt,checkShortUSDate:at,checkDate:nt,checkShortDate:rt,checkEuroDate:it,checkShortEuroDate:ot,checkDateDef:function(e){return ew.DATE_FORMAT.match(/^yyyy/)?nt(e):ew.DATE_FORMAT.match(/^yy/)?rt(e):ew.DATE_FORMAT.match(/^m/)&&ew.DATE_FORMAT.match(/yyyy$/)?tt(e):ew.DATE_FORMAT.match(/^m/)&&ew.DATE_FORMAT.match(/yy$/)?at(e):ew.DATE_FORMAT.match(/^d/)&&ew.DATE_FORMAT.match(/yyyy$/)?it(e):!(!ew.DATE_FORMAT.match(/^d/)||!ew.DATE_FORMAT.match(/yy$/))&&ot(e)},checkDateEx:st,unformatYear:lt,checkDay:dt,checkInteger:function(e){return!e||0==e.length||!e.includes(ew.DECIMAL_POINT)&&ct(e)},checkNumber:ct,stringToFloat:ut,stringToDate:function(e){var t=e.replace(/^(\d{4})-([0][1-9]|[1][0-2])-([0][1-9]|[1|2]\d|[3][0|1]) (?:(0\d|1\d|2[0-3]):([0-5]\d):([0-5]\d))?$/,"$1 $2 $3 $4 $5 $6").split(" ");return new Date(t[0],t[1]-1,t[2],t[3],t[4],t[5])},escapeRegExChars:pt,checkRange:ft,checkTime:ht,checkPhone:function(e){return!e||0==e.length||/^\(\d{3}\) ?\d{3}( |-)?\d{4}|^\d{3}( |-)?\d{3}( |-)?\d{4}$/.test(e.trim())},checkZip:function(e){return!e||0==e.length||/^\d{5}$|^\d{5}-\d{4}$/.test(e.trim())},checkCreditCard:function(e){if(!e||0==e.length)return!0;var t=e.replace(/\D/g,"");if(0==t.length)return!1;for(var a,n=t.length%2!=1,r=0,i=0,o=t.length;i<o;i++)a=parseInt(t.charAt(i),10),n?(r+=(a*=2)%10,a/10>=1&&r++,n=!1):(r+=a,n=!0);return r%10==0},checkSsn:function(e){return!e||0==e.length||/^(?!000)([0-6]\d{2}|7([0-6]\d|7[012]))([ -]?)(?!00)\d\d\3(?!0000)\d{4}$/.test(e.trim())},checkEmails:function(e,t){if(!e||0==e.length)return!0;for(var a=e.replace(/,/g,";").split(";"),n=0,r=a.length;n<r;n++){if(t>0&&r>t)return!1;if(!gt(a[n]))return!1}return!0},checkEmail:gt,checkGuid:function(e){return!e||0==e.length||/^(\{\w{8}-\w{4}-\w{4}-\w{4}-\w{12}\}|\w{8}-\w{4}-\w{4}-\w{4}-\w{12})$/.test(e.trim())},checkByRegEx:function(e,t){return!e||0==e.length||!!e.match(t)},showMessage:mt,random:wt,upload:function(t){var a=e(t);if(!a.data("blueimpFileupload")){var n=a.attr("name"),r=n.replace(/\$/g,"\\$"),i=a.data("table"),o=a.is("[multiple]"),s=a.closest(".form-group, [id^='el']"),l=a.prop("disabled")||"confirm"==a.closest("form").find("#confirm").val(),d=s.find("#ft_"+r),c=s.find("#fn_"+r),u=s.find("#fa_"+r),p=s.find("#fs_"+r),f=s.find("#fx_"+r),h=s.find("#fm_"+r),g=s.find("#fc_"+r),m=s.find(".custom-file-label"),w=m.html(),v=function(e){!o&&c.val()&&(confirm(ew.language.phrase("UploadOverwrite"))||(e.preventDefault(),e.stopPropagation()))},b=e.templates("#template-download"),y=e.templates("#template-upload"),E=ce(t),_=e(E);(l="confirm"==_.find("#confirm").val())&&_.find("span.fileinput-button").hide();var S=parseInt(g.val(),10),x=X(ew.API_JQUERY_UPLOAD_ACTION),O={id:n,table:i,session:ew.SESSION_ID,replace:o?"0":"1",exts:f.val(),maxsize:h.val(),maxfilecount:g.val()};a.fileupload({url:x,type:"POST",multipart:!0,autoUpload:!0,loadImageFileTypes:/^image\/(gif|jpe?g|png)$/i,loadVideoFileTypes:/^video\/mp4$/i,loadAudioFileTypes:/^audio\/(mpeg|mp3)$/i,acceptFileTypes:f.val()?new RegExp("\\.("+f.val().replace(/,/g,"|")+")$","i"):null,maxFileSize:parseInt(h.val(),10),maxNumberOfFiles:S>1?S:null,filesContainer:d,formData:O,uploadTemplateId:null,downloadTemplateId:null,uploadTemplate:y.render.bind(y),downloadTemplate:b.render.bind(b),previewMaxWidth:ew.UPLOAD_THUMBNAIL_WIDTH,previewMaxHeight:ew.UPLOAD_THUMBNAIL_HEIGHT,dropZone:s,pasteZone:s,messages:{acceptFileTypes:ew.language.phrase("UploadErrMsgAcceptFileTypes"),maxFileSize:ew.language.phrase("UploadErrMsgMaxFileSize"),maxNumberOfFiles:ew.language.phrase("UploadErrMsgMaxNumberOfFiles"),minFileSize:ew.language.phrase("UploadErrMsgMinFileSize")},readOnly:l}).on("fileuploaddone",(function(e,t){if(!t.result.files[0].error){var a=t.result.files[0].name,n=o&&c.val()?c.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[];n.push(a),c.val(n.join(ew.MULTIPLE_UPLOAD_SEPARATOR)),u.val("0"),o||d.children("tr:not(:last-child)").remove()}})).on("fileuploaddestroy",(function(t,a){var n=e(t.originalEvent.target).data("url"),r=new URLSearchParams(n.split("?")[1]),i=r.get("id"),o=r.get(i);if(o){var s=c.val()?c.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[],l=s.indexOf(o);l>-1&&s.splice(l,1),c.val(s.join(ew.MULTIPLE_UPLOAD_SEPARATOR)),u.val("0")}})).on("fileuploadchange",(function(t,a){var n;d.toggleClass("ew-has-rows",(null===(n=a.files)||void 0===n?void 0:n.length)>0);for(var r=c.val()?c.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[],i=0;i<a.files.length;i++)r.push(a.files[i].name);var o=parseInt(g.val(),10);if(e.isNumber(o)&&o>0&&r.length>o)return be(ew.language.phrase("UploadErrMsgMaxNumberOfFiles")),!1;var s=parseInt(p.val(),10);return e.isNumber(s)&&s>0&&r.join(ew.MULTIPLE_UPLOAD_SEPARATOR).length>s?(be(ew.language.phrase("UploadErrMsgMaxFileLength")),!1):void 0})).on("fileuploadadded fileuploadfinished fileuploaddestroyed",(function(e,t){var a,n,r;d.toggleClass("ew-has-rows",(null===(a=t.files)||void 0===a?void 0:a.length)>0||(null===(n=t.result)||void 0===n||null===(r=n.files)||void 0===r?void 0:r.length)>0);var i=c.val()?c.val().split(ew.MULTIPLE_UPLOAD_SEPARATOR):[];m.html(i.join(", ")||w)})).on("fileuploadadded",(function(e,t){var a;d.toggleClass("ew-has-rows",(null===(a=t.files)||void 0===a?void 0:a.length)>0),t.context.find(".start").click(v)})).on("fileuploadcompleted",(function(e,t){ne(e={target:t.context}),re(e),ew.updateDropdownPosition(),t.context.find("img").on("load",ew.updateDropdownPosition)})).click((function(){a.closest("span.fileinput-button").tooltip("hide")})),c.val()&&e.ajax({url:x,data:{id:n,table:i,session:ew.SESSION_ID},dataType:"json",context:this,success:function(r){if(r&&r[n]){var i=a.fileupload("option","done");i&&i.call(t,e.Event(),{result:{files:r[n]}})}l&&d.find("td.delete").hide()}})}},parseNumber:function(t,a){if(e.isString(t)){var n,r=[],i=(a=a||{thousandsSeparator:ew.THOUSANDS_SEP,decimalSeparator:ew.DECIMAL_POINT}).thousandsSeparator,o=a.decimalSeparator;i&&r.push(pt(i)+"(?=\\d)"),n=new RegExp("(?:"+r.join("|")+")","g"),"."===o&&(o=null),t=t.replace(n,""),t=o?t.replace(o,"."):t}return e.isString(t)&&""!==t.trim()&&(t=+t),e.isNumber&&isFinite(t)||(t=null),t},formatNumber:function(t,a){if(e.isNumber(t)){var n,r,i,o,s=t<0,l=t+"",d=(a=a||{thousandsSeparator:ew.THOUSANDS_SEP,decimalSeparator:ew.DECIMAL_POINT}).decimalPlaces,c=a.decimalSeparator||".",u=a.thousandsSeparator;if(e.isNumber(d)&&d>=0&&d<=20&&(l=t.toFixed(d)),"."!==c&&(l=l.replace(".",c)),u){for(n=(n=l.lastIndexOf(c))>-1?n:l.length,r=l.substring(n),i=0,o=n;o>0;o--)i%3==0&&o!==n&&(!s||o>1)&&(r=u+r),r=l.charAt(o-1)+r,i++;l=r}return l}return e.isValue(t)&&t.toString?t.toString():""},parseDate:function(t,a){var n=e.makeArray(arguments);if(e.isNumber(a)&&a>=0&&a<=17){var r,i=ew.DATE_FORMAT.toUpperCase(),o=ew.DATE_SEPARATOR,s=ew.TIME_SEPARATOR;switch(a){case 0:case 1:case 2:case 8:r=i+" HH"+s+"mm"+s+"ss";break;case 3:r="hh:mm:ss A";break;case 4:r="HH:mm:ss";break;case 5:r="YYYY"+o+"MM"+o+"DD";break;case 6:r="MM"+o+"DD"+o+"YYYY";break;case 7:r="DD"+o+"MM"+o+"YYYY";break;case 9:r="YYYY"+o+"MM"+o+"DD HH"+s+"mm"+s+"ss";break;case 10:r="MM"+o+"DD"+o+"YYYY HH"+s+"mm"+s+"ss";break;case 11:r="DD"+o+"MM"+o+"YYYY HH"+s+"mm"+s+"ss";break;case 12:r="YY"+o+"MM"+o+"DD";break;case 13:r="MM"+o+"DD"+o+"YY";break;case 14:r="DD"+o+"MM"+o+"YY";break;case 15:r="YY"+o+"MM"+o+"DD HH"+s+"mm"+s+"ss";break;case 16:r="MM"+o+"DD"+o+"YY HH"+s+"mm"+s+"ss";break;case 17:r="DD"+o+"MM"+o+"YY HH"+s+"mm"+s+"ss"}n[1]=[r,"YYYY-MM-DD HH"+s+"mm"+s+"ss"]}return moment.apply(this,n)},formatDate:function(e,t){return moment(e).format(t||ew.DATE_FORMAT.toUpperCase())},initPage:function(t){var a=t&&t.target?t.target:document,n=e(a),r=n.find("table.ew-table:not(.ew-export-table)");Array.prototype.forEach.call(a.querySelectorAll(".ew-grid-upper-panel, .ew-grid-lower-panel"),ew.initGridPanel),ew.renderJsTemplates(t),ae(t),function(t){for(var a,n=t&&t.target?t.target:document,r=e(n),i=U(ew.forms.ids());!(a=i()).done;){var o=a.value;r.find("#"+o)&&K.get(o).init()}}(t),ie(t),J(t),q(t),ne(t),re(t),n.find("[data-widget='treeview']").each((function(){adminlte.Treeview._jQueryInterface.call(e(this),"init")})),r.each(Te),n.find(".ew-btn-dropdown").on("shown.bs.dropdown",(function(){var t=e(this).removeClass("dropup"),a=e(window),n=t.find("> .dropdown-menu");t.toggleClass("dropup",n.offset().top+n.height()>a.scrollTop()+a.height())})),n.find("input[name=pageno]").on("keydown",(function(e){if("Enter"==e.key)return V.searchParams.set(this.name,parseInt(this.value)),window.location=Q(V.toString()),!1})),ew.IS_SCREEN_SM_MIN||n.find("."+ew.RESPONSIVE_TABLE_CLASS+" [data-toggle='dropdown']").parent().on("shown.bs.dropdown",(function(){var t=e(this),a=t.find(".dropdown-menu"),n=t.closest("."+ew.RESPONSIVE_TABLE_CLASS)[0];if(n.scrollHeight-n.clientHeight){var r=a.offset().top+a.outerHeight()-e(n).offset().top-n.clientHeight;r>0&&a.css(ew.CSS_FLIP?"right":"left","100%").css("top",parseFloat(a.css("top"))-r)}})),Z(t),ee(t);var i=n.find(".ew-report");i[0]&&(i.find(".card").on("collapsed.lte.widget",(function(){var t=e(this).closest("[class^='col-']"),a=t.css("min-height");a&&t.data("min-height",a),t.css("min-height",0)})).on("expanded.lte.widget",(function(){var t=e(this).closest("[class^='col-']"),a=t.css("min-height");a&&t.css("min-height",a)})),i.find("span.ew-group-toggle").on("click",(function(){ew.toggleGroup(this)}))),"undefined"!=typeof ew.USE_JAVASCRIPT_MESSAGE&&ew.USE_JAVASCRIPT_MESSAGE&&mt(t)},redirect:vt,togglePassword:function(t){var a=e(t.currentTarget),n=a.closest(".input-group").find("input"),r=a.find("i");"text"==n.attr("type")?(n.attr("type","password"),r.toggleClass("fa-eye-slash fa-eye")):"password"==n.attr("type")&&(n.attr("type","text"),r.toggleClass("fa-eye-slash fa-eye"))},exportWithCharts:function(t,a,n,r){var i=t.target,o=new URL(window.location.href),s=a.split("?"),l=e(i),d=r?"post":"get";n+="_"+Date.now(),o.pathname=s[0],o.search=s[1],o.searchParams.set("exportid",n),l.is(".dropdown-menu a")&&(l=l.closest(".btn-group"));var c=function(){var t=o.searchParams,a="1"==t.get("custom");if(r&&!a){var n=e(r).serialize();e.post(o,n,(function(e){mt(e)}))}else{var i=t.get("export");a&&["word","excel","pdf","email"].includes(i)?("email"==i&&(t.delete("export"),o.search=t.toString()+"&"+e(r).serialize()),e("iframe.ew-export").remove(),e("<iframe></iframe>").addClass("ew-export d-none").attr("src",o.toString()).appendTo(z.css("cursor","wait")),setTimeout((function(){z.css("cursor","default")}),5e3)):"print"==i?vt(o.toString(),r,d):te(o.toString(),null)}return!1},u=Object.keys(window.exportCharts);if(0==u.length)return c();z.css("cursor","wait");for(var p=[],f=0;f<u.length;f++){var h=u[f],g=window.exportCharts[h],m="exportfilename="+n+"_"+h+".png|exportformat=png|exportaction=download|exportparameters=undefined";g&&g.toBase64Image&&p.push({chart_engine:"Chart.js",stream_type:"base64",stream:g.toBase64Image(),parameters:m})}return e.ajax({url:X(ew.API_EXPORT_CHART_ACTION),data:{charts:JSON.stringify(p)},cache:!1,type:"POST"}).done((function(t){e.isString(t)&&(t=oe(t)),t.success?c():ew.alert(t.error)})).fail((function(e,t,a){ew.alert(a+": "+e.responseText)})).always((function(){z.css("cursor","default")})),!1},fixLayoutHeight:function(){H&&H.cancel(),H=e.later(50,null,(function(){var e=z.data("lte.layout");e&&e.fixLayoutHeight()}))},addEventHandlers:function(t){var a=ew.events[t];if(a)for(var n=0,r=Object.entries(a);n<r.length;n++){var i=r[n],o=i[0],s=i[1];e("[data-table="+t+"][data-field="+o+"]").on(s)}}});ew.IS_SCREEN_SM_MIN=window.matchMedia("(min-width: 768px)").matches,ew.MOBILE_DETECT=new MobileDetect(window.navigator.userAgent),ew.IS_MOBILE=!!ew.MOBILE_DETECT.mobile(),ew.IS_IE=ew.MOBILE_DETECT.version("MSIE")>0,window.exportCharts={},window.drillDownCharts={},ew.addSpinner(),Object.assign(ew,{MultiPage:function(t){var a=this;this.$form=null,this.formID=t,this.pageIndex=1,this.maxPageIndex=0,this.minPageIndex=0,this.pageIndexes=[],this.$pages=null,this.$collapses=null,this.isTab=!1,this.isCollapse=!1,this.lastPageSubmit=!1,this.hideDisabledButton=!1,this.hideInactivePages=!1,this.lockTabs=!1,this.hideTabs=!1,this.showPagerTop=!1,this.showPagerBottom=!1,this.pagerTemplate='<nav><ul class="pagination"><li class="page-item previous ew-prev"><a href="#" class="page-link"><span class="icon-prev"></span> {Prev}</a></li><li class="page-item next ew-next"><a href="#" class="page-link">{Next} <span class="icon-next"></span></a></li></ul></nav>';var n=function(e){e.preventDefault()},r=["lastPageSubmit","hideDisabledButton","hideInactivePages","lockTabs","hideTabs","showPagerTop","showPagerBottom","pagerTemplate"];this.set=function(){if(1==arguments.length&&e.isObject(arguments[0])){var t=arguments[0];for(var a in t){var n=a[0].toLowerCase()+a.substr(1);r.includes(n)&&(this[n]=t[a])}}},this.init=function(){var e=this.pagerTemplate.replace(/\{prev\}/i,ew.language.phrase("Prev")).replace(/\{next\}/i,ew.language.phrase("Next"));this.isTab?(this.showPagerTop&&this.$pages.closest(".tabbable, .ew-nav-tabs").before(e),this.showPagerBottom&&this.$pages.closest(".tabbable, .ew-nav-tabs").after(e),this.$form.find(".ew-prev").click((function(e){return a.$pages.off("show.bs.tab",n).filter(".active").parent().prev(":has([data-toggle=tab]:not(.ew-hidden):not(.ew-disabled))").find("[data-toggle=tab]").toggleClass("disabled d-none",!1).click(),!1})),this.$form.find(".ew-next").click((function(e){return a.$pages.off("show.bs.tab",n).filter(".active").parent().next(":has([data-toggle=tab]:not(.ew-hidden):not(.ew-disabled))").find("[data-toggle=tab]").toggleClass("disabled d-none",!1).click(),!1})),this.hideTabs&&this.$form.find(".ew-multi-page > .tabbable > .nav-tabs, .ew-multi-page > .ew-nav-tabs > .nav-tabs").hide()):this.isCollapse&&(this.showPagerTop&&this.$collapses.closest(".ew-accordion").before(e),this.showPagerBottom&&this.$collapses.closest(".ew-accordion").after(e),this.$form.find(".ew-prev").click((function(e){return a.$pages.closest(".card").filter(":has(.collapse.show)").prev(":has([data-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))").toggleClass("disabled d-none",!1).find("[data-toggle=collapse]").click(),!1})),this.$form.find(".ew-next").click((function(e){return a.$pages.closest(".card").filter(":has(.collapse.show)").next(":has([data-toggle=collapse]:not(.ew-hidden):not(.ew-disabled))").toggleClass("disabled d-none",!1).find("[data-toggle=collapse]").click(),!1}))),this.pageShow()},this.pageShow=function(){this.isTab?(this.lockTabs&&this.$pages.on("show.bs.tab",n),this.$pages.each((function(){var t=e(this);a.hideInactivePages&&t.toggleClass("d-none",!t.hasClass("active")),a.lockTabs&&t.toggleClass("disabled",!t.hasClass("active"))}))):this.isCollapse&&this.$pages.closest(".card").each((function(){var t=e(this);a.hideInactivePages&&t.toggleClass("d-none",!t.find(".collapse.show")[0])}));var t=this.lastPageSubmit&&this.pageIndex!=this.maxPageIndex,r=this.$form.closest(".content, .modal-content").find("#btn-action, button.ew-submit").prop("disabled",t).toggle(!this.hideDisabledButton||!t);e(".ew-captcha").toggle(r.is(":visible:not(:disabled)")),t=this.pageIndex<=this.minPageIndex,this.$form.find(".ew-prev").toggleClass("disabled",t),t=this.pageIndex>=this.maxPageIndex,this.$form.find(".ew-next").toggleClass("disabled",t)},this.gotoPage=function(e){if(!(e<=0||e<this.minPageIndex||e>this.maxPageIndex)&&this.pageIndex!=e){var t=this.$pages.eq(e-1);if(this.isTab)t.is(":not(.d-none):not(.disabled)")?t.click():t.parent().next(":has([data-toggle=tab]):not(.d-none):not(.disabled)").find("[data-toggle=tab]").toggleClass("disabled",!1).click();else if(this.isCollapse){var a=t.closest(".card");a.is(":not(.d-none)")?t.click():a.next(":has([data-toggle=collapse]):not(.d-none)").find("[data-toggle=collapse]").click()}this.pageIndex=e}},this.gotoPageByIndex=this.gotoPage,this.gotoPageByElement=function(t){this.gotoPage(parseInt(e(t).data("page"),10)||-1)},this.gotoPageByElementId=function(e){var t=this.$form.find("[data-page]").filter("[id='"+e+"'],[name='"+e+"'],[data-field='"+e+"']");this.gotoPageByElement(t)},this.togglePage=function(e,t){this.isTab?this.$pages.eq(e-1).toggleClass("d-none",!t):this.isCollapse&&this.$pages.eq(e-1).closest(".card").toggle("d-none",!t)},this.render=function(){this.$form=e("#"+t),this.pageIndexes=this.$form.find("[data-page]").map((function(){var t=parseInt(e(this).data("page"),10);return t>0?t:null})).get(),this.pageIndexes.sort((function(e,t){return e-t})),this.minPageIndex=this.pageIndexes[0],this.maxPageIndex=this.pageIndexes[this.pageIndexes.length-1];var n=this.$form.find("[data-toggle=tab]");if(n[0])this.$pages=n,this.isTab=!0,n.on("shown.bs.tab",(function(t){a.pageIndex=n.index(t.target)+1,a.pageShow(),e(e(this).attr("href")).find(".ew-google-map").each((function(){var e=ew.googleMaps[this.id];e&&e.map&&(google.maps.event.trigger(e.map,"resize"),e.map.setCenter(e.latlng))}))})),this.pageIndex=n.index(n.parent(".active"))+1;else if(this.$collapses=this.$form.find("[data-toggle=collapse]"),this.$collapses[0]){this.$pages=this.$collapses,this.isCollapse=!0;var r=this.$collapses.closest(".card-header").next();r.on("shown.bs.collapse",(function(t){a.pageIndex=r.index(t.target)+1,a.pageShow(),e(this).find(".ew-google-map").each((function(){var e=ew.googleMaps[this.id];e&&e.map&&(google.maps.event.trigger(e.map,"resize"),e.map.setCenter(e.latlng))}))})),this.pageIndex=r.index(r.hasClass("show"))+1}e((function(){a.init()}))}},Form:L,Validators:v},bt);var yt=e(document);loadjs.ready("load",(function(){e.views.settings.debugMode(ew.DEBUG),ew.setSessionTimer(),ew.initPage(),e("#ew-modal-dialog").on("load.ew",ew.initPage),e("#ew-add-opt-dialog").on("load.ew",ew.initPage);var t=ew.currentUrl.searchParams.get("hash");t&&e("html, body").animate({scrollTop:e("#"+t).offset().top},800),ew.removeSpinner(),yt.trigger("load")})),yt.on("addoption",(function(t,a){for(var n=a.data,r=a.parents,i=0,o=r.length;i<o;i++){var s=r[i];if(!s.length)return a.valid=!1;var l=n["ff"+(i>0?i+1:"")];if(!e.isUndefined(l)&&!s.includes(String(l)))return a.valid=!1}})),yt.on("show.bs.modal",".modal",(function(){var t=1050+e(".modal:visible").length;e(this).css("z-index",t),setTimeout((function(){e(".modal-backdrop").not(".modal-stack").css("z-index",t-1).addClass("modal-stack")}),0)})),yt.on("hidden.bs.modal",".modal",(function(){e(".modal:visible").length&&e("body").addClass("modal-open")})),e.extend({isBoolean:function(e){return"boolean"==typeof e},isNull:function(e){return null===e},isNumber:function(e){return"number"==typeof e&&isFinite(e)},isObject:function(e){return e&&("object"==typeof e||this.isFunction(e))||!1},isString:function(e){return"string"==typeof e},isUndefined:function(e){return"undefined"==typeof e},isValue:function(e){return this.isObject(e)||this.isString(e)||this.isNumber(e)||this.isBoolean(e)},isDate:function(e){return"date"===this.type(e)&&"Invalid Date"!==e.toString()&&!isNaN(e)},later:function(e,t,a,n,r){e=e||0,t=t||{};var i,o,s=a,l=n;if(this.isString(a)&&(s=t[a]),s)return this.isUndefined(n)||this.isArray(l)||(l=[n]),i=function(){s.apply(t,l||[])},o=r?setInterval(i,e):setTimeout(i,e),{interval:r,cancel:function(){this.interval?clearInterval(o):clearTimeout(o)}}}}),e.fn.fields=function(t){var a,n,r,i={},o=this.attr("id"),s=this[0],l=o.match(/^[xy](\d*)_/);l?(a=ew.getForm(s),n=this.data("table"),r=l[1]):s&&s.htmlForm&&(a=s.$element,n=s.id.replace(new RegExp("^f|"+s.pageId+"$","g"),""),r=e(s.htmlForm).data("rowindex"));var d="[data-table"+(n?"="+n:"")+"][data-field"+(t?"=x_"+t:"")+"]";return e.isValue(r)&&(d+="[name^=x"+r+"_]"),a&&d&&e(a).find(d).each((function(){var t=this.getAttribute("data-field").substr(2),a=this.getAttribute("name");t=/^y_/.test(a)?"y_"+t:t,i[t]=i[t]?i[t].add(this):e(this)})),t?i[t]:i},e.fn.extend({row:function(){var e,t=this.closest("#r_"+(null===(e=this.data("field"))||void 0===e?void 0:e.substr(2)));return t[0]||(t=this.closest(".ew-table > tbody > tr")),t},visible:function(e){var t,a=this.closest("#r_"+(null===(t=this.data("field"))||void 0===t?void 0:t.substr(2)));return a[0]||(a=this.closest("[id^=el]")),"undefined"!=typeof e?(a.toggle(e),this):$el.is(":visible")},readonly:function(e){return"undefined"!=typeof e?(this.prop("readOnly",e),this):this.prop("readOnly")},disabled:function(e){return"undefined"!=typeof e?(this.prop("disabled",e),this):this.prop("disabled")},value:function(e){var t=this.attr("type");if("undefined"!=typeof e){Array.isArray(e)||(e=[e]);var a="radio"==(t=this.attr("type"))||"checkbox"==t?this.get():this[0];return ew.isHiddenTextArea(this)?this.val(e).data("editor").save():(ew.selectOption(a,e),this.hasClass("select2-hidden-accessible")&&this.trigger("change")),this}if("checkbox"==t){var n=ew.getOptionValues(this.get());return 1==this.length?n.join():n}return"radio"==t?ew.getOptionValues(this.get()).join():ew.isHiddenTextArea(this)?(this.data("editor").save(),this.val()):this.val()},toNumber:function(){return ew.parseNumber(this.value())},toDate:function(){return ew.parseDate(this.value(),this.data("format"))},toJsDate:function(){return ew.parseDate(this.value(),this.data("format")).toDate()}}),e(window).off("load.lte.treeview");var Et=adminlte.Treeview;Et.prototype._toggle=Et.prototype.toggle,Et.prototype.toggle=function(t){var a=e(t.currentTarget),n=a.next(),r=a.attr("href"),i=e(t.target).closest(".menu-item-text");!n.is(".nav-treeview")||i[0]&&r&&"#"!=r&&"javascript:void(0);"!=r||this._toggle(t)},e("ul.dropdown-menu [data-toggle=dropdown]").on("click",(function(t){var a=e(this).attr("href");a&&"#"!=a&&"SPAN"==t.target.nodeName&&(window.location=a)}))}(jQuery);
//# sourceMappingURL=ew.min.js.map